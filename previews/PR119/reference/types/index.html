<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Types · PinCFlow.jl</title><meta name="title" content="Types · PinCFlow.jl"/><meta property="og:title" content="Types · PinCFlow.jl"/><meta property="twitter:title" content="Types · PinCFlow.jl"/><meta name="description" content="Documentation for PinCFlow.jl."/><meta property="og:description" content="Documentation for PinCFlow.jl."/><meta property="twitter:description" content="Documentation for PinCFlow.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PinCFlow.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/mountain_wave_simulation/">Mountain-wave simulation</a></li><li><a class="tocitem" href="../../examples/wkb_mountain_wave_simulation/">WKB mountain-wave simulation</a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../../theory/physics/">Physics</a></li><li><a class="tocitem" href="../../theory/numerics/">Numerics</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../pincflow/">PinCFlow</a></li><li class="is-active"><a class="tocitem" href>Types</a><ul class="internal"><li><a class="tocitem" href="#NamelistTypes"><span>NamelistTypes</span></a></li><li><a class="tocitem" href="#FoundationalTypes"><span>FoundationalTypes</span></a></li><li><a class="tocitem" href="#VariableTypes"><span>VariableTypes</span></a></li><li><a class="tocitem" href="#PoissonTypes"><span>PoissonTypes</span></a></li><li><a class="tocitem" href="#WKBTypes"><span>WKBTypes</span></a></li><li><a class="tocitem" href="#TracerTypes"><span>TracerTypes</span></a></li></ul></li><li><a class="tocitem" href="../mpi_operations/">MPIOperations</a></li><li><a class="tocitem" href="../boundaries/">Boundaries</a></li><li><a class="tocitem" href="../flux_calculator/">FluxCalculator</a></li><li><a class="tocitem" href="../poisson_solver/">PoissonSolver</a></li><li><a class="tocitem" href="../update/">Update</a></li><li><a class="tocitem" href="../msgwam/">MSGWaM</a></li><li><a class="tocitem" href="../integration/">Integration</a></li><li><a class="tocitem" href="../output/">Output</a></li></ul></li><li><a class="tocitem" href="../../developer_guide/">Developer guide</a></li><li><a class="tocitem" href="../../changelog/">Changelog</a></li><li><a class="tocitem" href="../../authors/">Authors</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>Types</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Types</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Atmospheric-Dynamics-GUF/PinCFlow.jl.git" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types" href="#PinCFlow.Types"><code>PinCFlow.Types</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Types</code></pre><p>Module for the construction of a single composite type that contains all information on the current model state.</p><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.NamelistTypes"><code>PinCFlow.Types.NamelistTypes</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes"><code>PinCFlow.Types.FoundationalTypes</code></a></p></li><li><p><a href="#PinCFlow.Types.PoissonTypes"><code>PinCFlow.Types.PoissonTypes</code></a></p></li><li><p><a href="#PinCFlow.Types.VariableTypes"><code>PinCFlow.Types.VariableTypes</code></a></p></li><li><p><a href="#PinCFlow.Types.WKBTypes"><code>PinCFlow.Types.WKBTypes</code></a></p></li><li><p><a href="#PinCFlow.Types.TracerTypes"><code>PinCFlow.Types.TracerTypes</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.AbstractPredictand" href="#PinCFlow.Types.AbstractPredictand"><code>PinCFlow.Types.AbstractPredictand</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractPredictand</code></pre><p>Abstract type for prognostic variables.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.Chi" href="#PinCFlow.Types.Chi"><code>PinCFlow.Types.Chi</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Chi</code></pre><p>Singleton that represents the tracer mixing ratio.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.Explicit" href="#PinCFlow.Types.Explicit"><code>PinCFlow.Types.Explicit</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Explicit</code></pre><p>Singleton for explicit integration in time.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.Implicit" href="#PinCFlow.Types.Implicit"><code>PinCFlow.Types.Implicit</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Implicit</code></pre><p>Singleton for implicit integration in time.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.P" href="#PinCFlow.Types.P"><code>PinCFlow.Types.P</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">P &lt;: AbstractPredictand</code></pre><p>Singleton that represents the mass-weighted potential temperature.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.PiP" href="#PinCFlow.Types.PiP"><code>PinCFlow.Types.PiP</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PiP &lt;: AbstractPredictand</code></pre><p>Singleton that represents the Exner-pressure fluctuations.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.Rho" href="#PinCFlow.Types.Rho"><code>PinCFlow.Types.Rho</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Rho &lt;: AbstractPredictand</code></pre><p>Singleton that represents density fluctuations predicted with the continuity equation.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.RhoP" href="#PinCFlow.Types.RhoP"><code>PinCFlow.Types.RhoP</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RhoP &lt;: AbstractPredictand</code></pre><p>Singleton that represents density fluctuations predicted with the auxiliary equation.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.State" href="#PinCFlow.Types.State"><code>PinCFlow.Types.State</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">State{
    A &lt;: Namelists,
    B &lt;: Time,
    C &lt;: Constants,
    D &lt;: Domain,
    E &lt;: Grid,
    F &lt;: Atmosphere,
    G &lt;: Sponge,
    H &lt;: Poisson,
    I &lt;: Variables,
    J &lt;: WKB,
    K &lt;: Tracer,
}</code></pre><p>Model state container.</p><p>An instance of this composite type holds complete information about the model configuration and simulation state, so that it is sufficient as primary input to most methods. The construction of such an instance is the first operation performed in <a href="../integration/#PinCFlow.Integration.integrate"><code>PinCFlow.Integration.integrate</code></a>, since it almost fully initializes the model.</p><pre><code class="language-julia hljs">State(namelists::Namelists)::State</code></pre><p>Construct a <code>State</code> instance and thus initialize the model.</p><p>This method first uses the parameters specified in <code>namelists</code> to construct instances of the composite types defined in <code>FoundationalTypes</code> (i.e. <code>Constants</code>, <code>Time</code>, <code>Domain</code>, <code>Grid</code>, <code>Atmosphere</code> and <code>Sponge</code>). It then uses these instances to prepare the arrays needed for the Poisson solver, the time integration and the parameterization of unresolved gravity waves with MSGWaM. Afterwards, only three operations of the initialization process remain (these are performed by <a href="../integration/#PinCFlow.Integration.integrate"><code>PinCFlow.Integration.integrate</code></a>), namely the initial cleaning, the setting of the initial ray-volume properties and the reading of input data in restart simulations.</p><p><strong>Fields</strong></p><ul><li><p><code>namelists::A</code>: Namelists with all model parameters.</p></li><li><p><code>time::B</code>: Runge-Kutta time integration coefficients.</p></li><li><p><code>constants::C</code>: Physical constants and reference values.</p></li><li><p><code>domain::D</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>grid::E</code>: Collection of parameters and fields that describe the grid.</p></li><li><p><code>atmosphere::F</code>: Atmospheric-background fields.</p></li><li><p><code>sponge::G</code>: Sponge parameters and damping coefficients.</p></li><li><p><code>poisson::H</code>: Workspace and solution arrays for the Poisson solver.</p></li><li><p><code>variables::I</code>: Arrays needed for the predictions of the prognostic variables.</p></li><li><p><code>wkb::J</code>: Container for WKB ray-tracing data and parameters.</p></li><li><p><code>tracer::K</code>: Tracer setup and parameters.</p></li></ul><p><strong>Arguments</strong></p><ul><li><code>namelists</code>: Namelists with all model parameters.</li></ul><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.FoundationalTypes.Constants"><code>PinCFlow.Types.FoundationalTypes.Constants</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes.Time"><code>PinCFlow.Types.FoundationalTypes.Time</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes.Domain"><code>PinCFlow.Types.FoundationalTypes.Domain</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes.Grid"><code>PinCFlow.Types.FoundationalTypes.Grid</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes.Atmosphere"><code>PinCFlow.Types.FoundationalTypes.Atmosphere</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes.Sponge"><code>PinCFlow.Types.FoundationalTypes.Sponge</code></a></p></li><li><p><a href="#PinCFlow.Types.PoissonTypes.Poisson"><code>PinCFlow.Types.PoissonTypes.Poisson</code></a></p></li><li><p><a href="#PinCFlow.Types.VariableTypes.Variables"><code>PinCFlow.Types.VariableTypes.Variables</code></a></p></li><li><p><a href="#PinCFlow.Types.WKBTypes.WKB"><code>PinCFlow.Types.WKBTypes.WKB</code></a></p></li><li><p><a href="#PinCFlow.Types.TracerTypes.Tracer"><code>PinCFlow.Types.TracerTypes.Tracer</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.Theta" href="#PinCFlow.Types.Theta"><code>PinCFlow.Types.Theta</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Theta</code></pre><p>Singleton that represents the potential temperature.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.U" href="#PinCFlow.Types.U"><code>PinCFlow.Types.U</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">U &lt;: AbstractPredictand</code></pre><p>Singleton that represents the zonal wind.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.V" href="#PinCFlow.Types.V"><code>PinCFlow.Types.V</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">V &lt;: AbstractPredictand</code></pre><p>Singleton that represents the meridional wind.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.W" href="#PinCFlow.Types.W"><code>PinCFlow.Types.W</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">W &lt;: AbstractPredictand</code></pre><p>Singleton that represents the (transformed) vertical wind.</p></div></section></article><h2 id="NamelistTypes"><a class="docs-heading-anchor" href="#NamelistTypes">NamelistTypes</a><a id="NamelistTypes-1"></a><a class="docs-heading-anchor-permalink" href="#NamelistTypes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes" href="#PinCFlow.Types.NamelistTypes"><code>PinCFlow.Types.NamelistTypes</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NamelistTypes</code></pre><p>Module that contains all namelist types.</p><p>Provides constructors that allow setting only specific parameters and using default values for the rest.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.AbstractBackground" href="#PinCFlow.Types.NamelistTypes.AbstractBackground"><code>PinCFlow.Types.NamelistTypes.AbstractBackground</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractBackground</code></pre><p>Abstract type for atmospheric background configurations.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.AbstractLimiter" href="#PinCFlow.Types.NamelistTypes.AbstractLimiter"><code>PinCFlow.Types.NamelistTypes.AbstractLimiter</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractLimiter</code></pre><p>Abstract type for flux limiters used in the reconstruction.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.AbstractMergeMode" href="#PinCFlow.Types.NamelistTypes.AbstractMergeMode"><code>PinCFlow.Types.NamelistTypes.AbstractMergeMode</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractMergeMode</code></pre><p>Abstract type for ray-volume merge algorithms.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.AbstractModel" href="#PinCFlow.Types.NamelistTypes.AbstractModel"><code>PinCFlow.Types.NamelistTypes.AbstractModel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractModel</code></pre><p>Abstract type for levels of compressibility.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.AbstractSponge" href="#PinCFlow.Types.NamelistTypes.AbstractSponge"><code>PinCFlow.Types.NamelistTypes.AbstractSponge</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractSponge</code></pre><p>Abstract type for sponge configurations.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.AbstractTracer" href="#PinCFlow.Types.NamelistTypes.AbstractTracer"><code>PinCFlow.Types.NamelistTypes.AbstractTracer</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractTracer</code></pre><p>Abstract type for the inclusion of a tracer.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.AbstractWKBFilter" href="#PinCFlow.Types.NamelistTypes.AbstractWKBFilter"><code>PinCFlow.Types.NamelistTypes.AbstractWKBFilter</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractWKBFilter</code></pre><p>Abstract type for filtering methods applied to mean-flow tendencies.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.AbstractWKBMode" href="#PinCFlow.Types.NamelistTypes.AbstractWKBMode"><code>PinCFlow.Types.NamelistTypes.AbstractWKBMode</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractWKBMode</code></pre><p>Abstract type for approximations in WKB theory.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.AtmosphereNamelist" href="#PinCFlow.Types.NamelistTypes.AtmosphereNamelist"><code>PinCFlow.Types.NamelistTypes.AtmosphereNamelist</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AtmosphereNamelist{
    A &lt;: AbstractModel,
    B &lt;: Bool,
    C &lt;: AbstractFloat,
    D &lt;: AbstractBackground,
    E &lt;: Function,
    F &lt;: Function,
    G &lt;: Function,
    H &lt;: Function,
    I &lt;: Function,
    J &lt;: Function,
}</code></pre><p>Namelist for parameters used in the definition of the atmospheric background and the initialization of prognostic variables.</p><pre><code class="language-julia hljs">AtmosphereNamelist(;
    model::AbstractModel = PseudoIncompressible(),
    specify_reynolds_number::Bool = false,
    inverse_reynolds_number::AbstractFloat = 0.0E+0,
    kinematic_viscosity::AbstractFloat = 1.5E-5,
    thermal_conductivity::AbstractFloat = 3.0E-5,
    kinematic_diffusivity::AbstractFloat = 0.0E+0,
    background::AbstractBackground = Isothermal(),
    buoyancy_frequency::AbstractFloat = 1.0E-2,
    potential_temperature::AbstractFloat = 3.0E+2,
    temperature::AbstractFloat = 3.0E+2,
    ground_pressure::AbstractFloat = 1.0E+5,
    coriolis_frequency::AbstractFloat = 1.0E-4,
    tropopause_height::AbstractFloat = 1.0E+4,
    troposphere_lapse_rate::AbstractFloat = 6.5E-3,
    stratosphere_lapse_rate::AbstractFloat = -5.0E-3,
    initial_rhop::Function = (x, y, z) -&gt; 0.0,
    initial_thetap::Function = (x, y, z) -&gt; 0.0,
    initial_u::Function = (x, y, z) -&gt; 0.0,
    initial_v::Function = (x, y, z) -&gt; 0.0,
    initial_w::Function = (x, y, z) -&gt; 0.0,
    initial_pip::Function = (x, y, z) -&gt; 0.0,
)::AtmosphereNamelist</code></pre><p>Construct an <code>AtmosphereNamelist</code> instance with the given keyword arguments as properties.</p><p><strong>Fields/Keywords</strong></p><ul><li><p><code>model::A</code>: Dynamic equations.</p></li><li><p><code>specify_reynolds_number::B</code>: Flag to specify inverse Reynolds number instead of viscosity.</p></li><li><p><code>inverse_reynolds_number::C</code>: Inverse Reynolds number.</p></li><li><p><code>kinematic_viscosity::C</code>: Kinematic viscosity at the surface.</p></li><li><p><code>thermal_conductivity::C</code>: Thermal conductivity at the surface.</p></li><li><p><code>kinematic_diffusivity::C</code>: Kinematic diffusivity at the surface.</p></li><li><p><code>background::D</code>: Atmospheric background.</p></li><li><p><code>buoyancy_frequency::C</code>: Buoyancy frequency if <code>background == StratifiedBoussinesq()</code>.</p></li><li><p><code>potential_temperature::C</code>: Reference potential temperature.</p></li><li><p><code>temperature::C</code>: Reference temperature.</p></li><li><p><code>ground_pressure::C</code>: Reference pressure.</p></li><li><p><code>coriolis_frequency::C</code>: Coriolis frequency of the <span>$f$</span>-plane.</p></li><li><p><code>tropopause_height::C</code>: Height of the tropopause for <code>background == Realistic()</code> or <code>background == LapseRates()</code>.</p></li><li><p><code>troposphere_lapse_rate::C</code>: Lapse rate in the troposphere for <code>background == LapseRates()</code>.</p></li><li><p><code>stratosphere_lapse_rate::C</code>: Lapse rate in the stratosphere for <code>background == LapseRates()</code>.</p></li><li><p><code>initial_rhop::E</code>: Function used to initialize the density fluctuations.</p></li><li><p><code>initial_thetap::F</code>: Function used to initialize the potential-temperature fluctuations (only relevant in compressible mode).</p></li><li><p><code>initial_u::G</code>: Function used to initialize the zonal wind.</p></li><li><p><code>initial_v::H</code>: Function used to initialize the meridional wind.</p></li><li><p><code>initial_w::I</code>: Function used to initialize the vertical wind.</p></li><li><p><code>initial_pip::J</code>: Function used to initialize the Exner-pressure fluctuations.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.Boussinesq" href="#PinCFlow.Types.NamelistTypes.Boussinesq"><code>PinCFlow.Types.NamelistTypes.Boussinesq</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Boussinesq &lt;: AbstractModel</code></pre><p>Singleton for Boussinesq dynamics.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.Box" href="#PinCFlow.Types.NamelistTypes.Box"><code>PinCFlow.Types.NamelistTypes.Box</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Box &lt;: AbstractWKBFilter</code></pre><p>Singleton for a box filter as smoothing method applied to mean-flow tendencies.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.COSMOSponge" href="#PinCFlow.Types.NamelistTypes.COSMOSponge"><code>PinCFlow.Types.NamelistTypes.COSMOSponge</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">COSMOSponge &lt;: AbstractSponge</code></pre><p>Singleton for a sponge configuration similar to that used in the COSMO model (squared cosine with time-step-dependent maximum).</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.Compressible" href="#PinCFlow.Types.NamelistTypes.Compressible"><code>PinCFlow.Types.NamelistTypes.Compressible</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Compressible &lt;: AbstractModel</code></pre><p>Singleton for compressible dynamics.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.ConstantWaveAction" href="#PinCFlow.Types.NamelistTypes.ConstantWaveAction"><code>PinCFlow.Types.NamelistTypes.ConstantWaveAction</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConstantWaveAction &lt;: AbstractMergeMode</code></pre><p>Singleton for the constant-wave-action ray-volume merging algorithm.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.ConstantWaveEnergy" href="#PinCFlow.Types.NamelistTypes.ConstantWaveEnergy"><code>PinCFlow.Types.NamelistTypes.ConstantWaveEnergy</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConstantWaveEnergy &lt;: AbstractMergeMode</code></pre><p>Singleton for the constant-wave-energy ray-volume merging algorithm.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.DiscretizationNamelist" href="#PinCFlow.Types.NamelistTypes.DiscretizationNamelist"><code>PinCFlow.Types.NamelistTypes.DiscretizationNamelist</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DiscretizationNamelist{A &lt;: AbstractFloat, B &lt;: Bool, C &lt;: AbstractLimiter}</code></pre><p>Namelist for parameters describing the discretization.</p><pre><code class="language-julia hljs">DiscretizationNamelist(;
    cfl_number::AbstractFloat = 5.0E-1,
    wkb_cfl_number::AbstractFloat = 5.0E-1,
    dtmin::AbstractFloat = 1.0E-6,
    dtmax::AbstractFloat = 1.0E+3,
    adaptive_time_step::Bool = true,
    limiter_type::AbstractLimiter = MCVariant(),
)::DiscretizationNamelist</code></pre><p>Construct a <code>DiscretizationNamelist</code> instance with the given keyword arguments as properties.</p><p><strong>Fields/Keywords</strong></p><ul><li><p><code>cfl_number::A</code>: Number used for the CFL condition in the time step computation.</p></li><li><p><code>wkb_cfl_number::A</code>: Number used for the WKB-CFL condition in the time step computation.</p></li><li><p><code>dtmin::A</code>: Minimum time step allowed for the integration.</p></li><li><p><code>dtmax::A</code>: Maximum time step allowed for the integration.</p></li><li><p><code>adaptive_time_step::B</code>: Switch for using stability criteria to determine the time step. If set to <code>false</code>, <code>dtmax</code> is used as a fixed time step.</p></li><li><p><code>limiter_type::C</code>: Flux limiter used by the MUSCL scheme.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.DomainNamelist" href="#PinCFlow.Types.NamelistTypes.DomainNamelist"><code>PinCFlow.Types.NamelistTypes.DomainNamelist</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DomainNamelist{A &lt;: Integer, B &lt;: NTuple{2, &lt;:AbstractFloat}, C &lt;: MPI.Comm}</code></pre><p>Namelist for parameters describing the model domain.</p><pre><code class="language-julia hljs">DomainNamelist(;
    x_size::Integer = 3,
    y_size::Integer = 3,
    z_size::Integer = 3,
    nbx::Integer = 3,
    nby::Integer = 3,
    nbz::Integer = 3,
    lx::AbstractFloat = 1.0E+3,
    ly::AbstractFloat = 1.0E+3,
    lz::AbstractFloat = 1.0E+3,
    npx::Integer = 1,
    npy::Integer = 1,
    npz::Integer = 1,
    base_comm::MPI.Comm = MPI.COMM_WORLD,
)::DomainNamelist</code></pre><p>Construct a <code>DomainNamelist</code> instance with the given keyword arguments as properties.</p><p><strong>Fields/Keywords</strong></p><ul><li><p><code>x_size::A</code>: Number of grid cells in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>y_size::A</code>: Number of grid cells in <span>$\widehat{y}$</span>-direction.</p></li><li><p><code>z_size::A</code>: Number of grid cells in <span>$\widehat{z}$</span>-direction.</p></li><li><p><code>nbx::A</code>: Number of boundary/halo cells in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>nby::A</code>: Number of boundary/halo cells in <span>$\widehat{y}$</span>-direction.</p></li><li><p><code>nbz::A</code>: Number of boundary/halo cells in <span>$\widehat{z}$</span>-direction.</p></li><li><p><code>lx::B</code>: Domain extent in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>ly::B</code>: Domain extent in <span>$\widehat{y}$</span>-direction.</p></li><li><p><code>lz::B</code>: Domain extent in <span>$\widehat{z}$</span>-direction.</p></li><li><p><code>npx::A</code>: Number of MPI processes in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>npy::A</code>: Number of MPI processes in <span>$\widehat{y}$</span>-direction.</p></li><li><p><code>npz::A</code>: Number of MPI processes in <span>$\widehat{z}$</span>-direction.</p></li><li><p><code>base_comm::C</code>: MPI base communicator.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.ExponentialSponge" href="#PinCFlow.Types.NamelistTypes.ExponentialSponge"><code>PinCFlow.Types.NamelistTypes.ExponentialSponge</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ExponentialSponge &lt;: AbstractSponge</code></pre><p>Singleton for an exponentially increasing Rayleigh damping in the entire Domain.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.GridNamelist" href="#PinCFlow.Types.NamelistTypes.GridNamelist"><code>PinCFlow.Types.NamelistTypes.GridNamelist</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GridNamelist{A &lt;: AbstractFloat, B &lt;: Function, C &lt;: Function}</code></pre><p>Namelist for parameters describing the grid.</p><pre><code class="language-julia hljs">GridNamelist(;
    stretch_exponent::AbstractFloat = 1.0E+0,
    resolved_topography::Function = (x, y) -&gt; 0.0,
    unresolved_topography::Function = (alpha, x, y) -&gt; (0.0, 0.0, 0.0),
)::GridNamelist</code></pre><p>Construct a <code>GridNamelist</code> instance with the given keyword arguments as properties.</p><p><strong>Fields/Keywords</strong></p><ul><li><p><code>stretch_exponent::A</code>: Vertical-grid-stretching parameter.</p></li><li><p><code>resolved_topography::B</code>: Function that returns the resolved topography at a specified horizontal position.</p></li><li><p><code>resolved_topography::C</code>: Function that returns a specified spectral mode of the unresolved topography at a specified horizontal position.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.Isentropic" href="#PinCFlow.Types.NamelistTypes.Isentropic"><code>PinCFlow.Types.NamelistTypes.Isentropic</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Isentropic &lt;: AbstractBackground</code></pre><p>Singleton for an isentropic atmosphere in pseudo-incompressible or compressible mode.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.Isothermal" href="#PinCFlow.Types.NamelistTypes.Isothermal"><code>PinCFlow.Types.NamelistTypes.Isothermal</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Isothermal &lt;: AbstractBackground</code></pre><p>Singleton for an isothermal atmosphere in pseudo-incompressible or compressible mode.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.LapseRates" href="#PinCFlow.Types.NamelistTypes.LapseRates"><code>PinCFlow.Types.NamelistTypes.LapseRates</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LapseRates &lt;: AbstractBackground</code></pre><p>Singleton for an atmosphere with different lapse rates in the troposphere and stratosphere in pseudo-incompressible or compressible mode.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.MCVariant" href="#PinCFlow.Types.NamelistTypes.MCVariant"><code>PinCFlow.Types.NamelistTypes.MCVariant</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MCVariant &lt;: AbstractLimiter</code></pre><p>Singleton for the MC-Variant limiter function (used in reconstruction).</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.MultiColumn" href="#PinCFlow.Types.NamelistTypes.MultiColumn"><code>PinCFlow.Types.NamelistTypes.MultiColumn</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MultiColumn &lt;: AbstractWKBMode</code></pre><p>Singleton for the multi-column approximation in MSGWaM.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.Namelists" href="#PinCFlow.Types.NamelistTypes.Namelists"><code>PinCFlow.Types.NamelistTypes.Namelists</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Namelists{
    A &lt;: DomainNamelist,
    B &lt;: OutputNamelist,
    C &lt;: DiscretizationNamelist,
    D &lt;: PoissonNamelist,
    E &lt;: AtmosphereNamelist,
    F &lt;: GridNamelist,
    G &lt;: SpongeNamelist,
    H &lt;: WKBNamelist,
    I &lt;: TracerNamelist,
}</code></pre><p>Collection of all configurable model parameters.</p><pre><code class="language-julia hljs">Namelists(;
    domain::DomainNamelist = DomainNamelist(),
    output::OutputNamelist = OutputNamelist(),
    discretization::DiscretizationNamelist = DiscretizationNamelist(),
    poisson::PoissonNamelist = PoissonNamelist(),
    atmosphere::AtmosphereNamelist = AtmosphereNamelist(),
    grid::GridNamelist = GridNamelist(),
    sponge::SpongeNamelist = SpongeNamelist(),
    wkb::WKBNamelist = WKBNamelist(),
    tracer::TracerNamelist = TracerNamelist(),
)::Namelists</code></pre><p>Construct a <code>Namelists</code> instance with the given keyword arguments as properties.</p><p><strong>Fields/Keywords</strong></p><ul><li><p><code>domain::A</code>: Namelist for parameters describing the model domain.</p></li><li><p><code>output::B</code>: Namelist for I/O parameters.</p></li><li><p><code>discretization::C</code>: Namelist for parameters describing discretization.</p></li><li><p><code>poisson::D</code>: Namelist for parameters used by the Poisson solver.</p></li><li><p><code>atmosphere::E</code>: Namelist for parameters describing the atmospheric background.</p></li><li><p><code>grid::F</code>: Namelist for parameters describing the grid.</p></li><li><p><code>sponge::G</code>: Namelist for parameters describing the sponge.</p></li><li><p><code>wkb::H</code>: Namelist for parameters used by MSGWaM.</p></li><li><p><code>tracer::I</code>: Namelist for parameters configuring tracer transport.</p></li></ul><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.NamelistTypes.DomainNamelist"><code>PinCFlow.Types.NamelistTypes.DomainNamelist</code></a></p></li><li><p><a href="#PinCFlow.Types.NamelistTypes.OutputNamelist"><code>PinCFlow.Types.NamelistTypes.OutputNamelist</code></a></p></li><li><p><a href="#PinCFlow.Types.NamelistTypes.DiscretizationNamelist"><code>PinCFlow.Types.NamelistTypes.DiscretizationNamelist</code></a></p></li><li><p><a href="#PinCFlow.Types.NamelistTypes.PoissonNamelist"><code>PinCFlow.Types.NamelistTypes.PoissonNamelist</code></a></p></li><li><p><a href="#PinCFlow.Types.NamelistTypes.AtmosphereNamelist"><code>PinCFlow.Types.NamelistTypes.AtmosphereNamelist</code></a></p></li><li><p><a href="#PinCFlow.Types.NamelistTypes.GridNamelist"><code>PinCFlow.Types.NamelistTypes.GridNamelist</code></a></p></li><li><p><a href="#PinCFlow.Types.NamelistTypes.SpongeNamelist"><code>PinCFlow.Types.NamelistTypes.SpongeNamelist</code></a></p></li><li><p><a href="#PinCFlow.Types.NamelistTypes.WKBNamelist"><code>PinCFlow.Types.NamelistTypes.WKBNamelist</code></a></p></li><li><p><a href="#PinCFlow.Types.NamelistTypes.TracerNamelist"><code>PinCFlow.Types.NamelistTypes.TracerNamelist</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.NoTracer" href="#PinCFlow.Types.NamelistTypes.NoTracer"><code>PinCFlow.Types.NamelistTypes.NoTracer</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NoTracer &lt;: AbstractTracer</code></pre><p>Singleton for model configurations without a tracer.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.NoWKB" href="#PinCFlow.Types.NamelistTypes.NoWKB"><code>PinCFlow.Types.NamelistTypes.NoWKB</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NoWKB &lt;: AbstractWKBMode</code></pre><p>Singleton for switching off MSGWaM.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.OutputNamelist" href="#PinCFlow.Types.NamelistTypes.OutputNamelist"><code>PinCFlow.Types.NamelistTypes.OutputNamelist</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">OutputNamelist{
    A &lt;: Tuple{Vararg{Symbol}},
    B &lt;: Bool,
    C &lt;: Integer,
    D &lt;: AbstractFloat,
    E &lt;: AbstractString,
}</code></pre><p>Namelist for I/O parameters.</p><pre><code class="language-julia hljs">OutputNamelist(;
    output_variables::Tuple{Vararg{Symbol}} = (),
    save_ray_volumes::Bool = false,
    prepare_restart::Bool = false,
    restart::Bool = false,
    iin::Integer = -1,
    output_steps::Bool = false,
    nout::Integer = 1,
    iterations::Integer = 1,
    output_interval::AbstractFloat = 3.6E+3,
    tmax::AbstractFloat = 3.6E+3,
    input_file::AbstractString = &quot;./pincflow_input.h5&quot;,
    output_file::AbstractString = &quot;./pincflow_output.h5&quot;,
)::OutputNamelist</code></pre><p>Construct an <code>OutputNamelist</code> instance with the given keyword arguments as properties.</p><p><strong>Fields/Keywords</strong></p><ul><li><p><code>output_variables::A</code>: A tuple of symbols representing the variables that should be written to the output file.</p></li><li><p><code>save_ray_volumes::B</code>: A boolean indicating whether to write ray-volume data.</p></li><li><p><code>prepare_restart::B</code>: A boolean indicating whether to write all variables needed for restart simulations.</p></li><li><p><code>restart::B</code>: A boolean indicating whether to initialize with data from a previous state (as written in <code>input_file</code>).</p></li><li><p><code>iin::C</code>: Temporal index in <code>input_file</code> at which to read the data to initialize with in restart simulations.</p></li><li><p><code>output_steps::B</code>: If set to <code>true</code>, write output every <code>nout</code> time steps.</p></li><li><p><code>nout::C</code>: Output interval (in indices) if <code>output_steps == true</code>.</p></li><li><p><code>iterations::C</code>: Maximum number of iterations if <code>output_steps == true</code>.</p></li><li><p><code>output_interval::D</code>: Output interval (in physical time) if <code>output_steps == false</code>.</p></li><li><p><code>tmax::D</code>: Simulation time if <code>output_steps == false</code>.</p></li><li><p><code>input_file::E</code>: File from which to read input data in restart simulations.</p></li><li><p><code>output_file::E</code>: File to which output data is written.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.PoissonNamelist" href="#PinCFlow.Types.NamelistTypes.PoissonNamelist"><code>PinCFlow.Types.NamelistTypes.PoissonNamelist</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PoissonNamelist{A &lt;: AbstractFloat, B &lt;: Integer, C &lt;: Bool}</code></pre><p>Namelist for parameters used by the Poisson solver.</p><pre><code class="language-julia hljs">PoissonNamelist(;
    tolerance::AbstractFloat = 1.0E-8,
    poisson_iterations::Integer = 1000,
    preconditioner::Bool = true,
    dtau::AbstractFloat = 1.0E+0,
    preconditioner_iterations::Integer = 2,
    initial_cleaning::Bool = true,
    tolerance_is_relative::Bool = false,
)::PoissonNamelist</code></pre><p>Construct a <code>PoissonNamelists</code> instance with the given keyword arguments as properties.</p><p><strong>Fields/Keywords</strong></p><ul><li><p><code>tolerance::A</code>: Tolerance for the convergence criterion of the Poisson solver.</p></li><li><p><code>poisson_iterations::B</code>: Maximum number of iterations performed by the Poisson solver before it terminates regardless of convergence.</p></li><li><p><code>preconditioner::C</code>: Whether to use a preconditioner to accelerate the convergence of the Poisson solver.</p></li><li><p><code>dtau::A</code>: Pseudo-time step coefficient used by the preconditioner.</p></li><li><p><code>preconditioner_iterations::B</code>: Number of iterations performed by the preconditioner.</p></li><li><p><code>initial_cleaning::C</code>: Whether to solve the Poisson problem at initialization to guarantee an initially divergence-free state.</p></li><li><p><code>tolerance_is_relative::C</code>: If set to <code>true</code>, the tolerance used for the convergence criterion is given by <code>tolerance</code>. If set to <code>false</code>, the tolerance is given by <code>tolerance</code> divided by a reference value determined from the right-hand side.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.PolynomialSponge" href="#PinCFlow.Types.NamelistTypes.PolynomialSponge"><code>PinCFlow.Types.NamelistTypes.PolynomialSponge</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PolynomialSponge &lt;: AbstractSponge</code></pre><p>Singleton for a sponge configuration with polynomial profiles.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.PseudoIncompressible" href="#PinCFlow.Types.NamelistTypes.PseudoIncompressible"><code>PinCFlow.Types.NamelistTypes.PseudoIncompressible</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PseudoIncompressible &lt;: AbstractModel</code></pre><p>Singleton for pseudo-incompressible dynamics.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.Realistic" href="#PinCFlow.Types.NamelistTypes.Realistic"><code>PinCFlow.Types.NamelistTypes.Realistic</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Realistic &lt;: AbstractBackground</code></pre><p>Singleton for a realistic atmosphere in pseudo-incompressible or compressible mode (isentropic troposphere and isothermal stratosphere).</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.Shapiro" href="#PinCFlow.Types.NamelistTypes.Shapiro"><code>PinCFlow.Types.NamelistTypes.Shapiro</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Shapiro &lt;: AbstractWKBFilter</code></pre><p>Singleton for a Shapiro filter as smoothing method applied to mean-flow tendencies.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.SingleColumn" href="#PinCFlow.Types.NamelistTypes.SingleColumn"><code>PinCFlow.Types.NamelistTypes.SingleColumn</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SingleColumn &lt;: AbstractWKBMode</code></pre><p>Singleton for the single-column approximation in MSGWaM.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.SinusoidalSponge" href="#PinCFlow.Types.NamelistTypes.SinusoidalSponge"><code>PinCFlow.Types.NamelistTypes.SinusoidalSponge</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SinusoidalSponge &lt;: AbstractSponge</code></pre><p>Singleton for a sponge configuration with sinusoidal profiles.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.SpongeNamelist" href="#PinCFlow.Types.NamelistTypes.SpongeNamelist"><code>PinCFlow.Types.NamelistTypes.SpongeNamelist</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SpongeNamelist{
    A &lt;: Bool,
    B &lt;: AbstractFloat,
    C &lt;: AbstractSponge,
    D &lt;: Integer,
    E &lt;: NTuple{3, &lt;:AbstractFloat},
}</code></pre><p>Namelist for parameters describing the sponge.</p><pre><code class="language-julia hljs">SpongeNamelist(;
    damp_horizontal_wind_on_rhs::Bool = false,
    sponge_extent::AbstractFloat = 5.0E-1,
    alpharmax::AbstractFloat = 0.0E+0,
    betarmax::AbstractFloat = 0.0E+0,
    lateral_sponge::Bool = false,
    sponge_type::AbstractSponge = PolynomialSponge(),
    sponge_order::Integer = 1,
    cosmo_steps::Integer = 1,
    relax_to_mean::Bool = true,
    perturbation_period::AbstractFloat = 0.0E+0,
    perturbation_amplitude::AbstractFloat = 0.0E+0,
    relaxation_wind::NTuple{3, &lt;:AbstractFloat} = (0.0E+0, 0.0E+0, 0.0E+0),
)::SpongeNamelist</code></pre><p>Construct a <code>SpongeNamelist</code> instance with the given keyword arguments as properties.</p><p><strong>Fields/Keywords</strong></p><ul><li><p><code>damp_horizontal_wind_on_rhs::A</code>: Switch for applying the RHS sponge to the horizontal wind.</p></li><li><p><code>sponge_extent::B</code>: Fractional vertical extent of the sponge.</p></li><li><p><code>alpharmax::B</code>: Rayleigh-damping coefficient of the LHS sponge.</p></li><li><p><code>betarmax::B</code>: Rayleigh-damping coefficient of the RHS sponge, multiplied by the time step.</p></li><li><p><code>lateral_sponge::A</code>: Switch for the lateral LHS sponge.</p></li><li><p><code>sponge_type::C</code>: Profile of the LHS sponge.</p></li><li><p><code>sponge_order::D</code>: Order of the polynomial LHS sponge.</p></li><li><p><code>cosmo_steps::D</code>: Factor by which the time step is multiplied in the damping coefficient of the COSMO-like LHS sponge.</p></li><li><p><code>relax_to_mean::A</code>: Switch for relaxing the wind towards its averages on the terrain-following surfaces. If set to <code>false</code>, the wind is relaxed towards <code>relaxation_wind</code>.</p></li><li><p><code>perturbation_period::B</code>: Period of an oscillating perturbation on top of <code>relaxation_wind</code>.</p></li><li><p><code>perturbation_amplitude::B</code>: Amplitude of an oscillating perturbation on top of <code>relaxation_wind</code>.</p></li><li><p><code>relaxation_wind::E</code>: Wind to be obtained through Rayleigh damping in the LHS sponge.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.SteadyState" href="#PinCFlow.Types.NamelistTypes.SteadyState"><code>PinCFlow.Types.NamelistTypes.SteadyState</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SteadyState &lt;: AbstractWKBMode</code></pre><p>Singleton for the steady-state approximation in MSGWaM.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.StratifiedBoussinesq" href="#PinCFlow.Types.NamelistTypes.StratifiedBoussinesq"><code>PinCFlow.Types.NamelistTypes.StratifiedBoussinesq</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">StratifiedBoussinesq &lt;: AbstractBackground</code></pre><p>Singleton for a Boussinesq atmosphere with stratification.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.TracerNamelist" href="#PinCFlow.Types.NamelistTypes.TracerNamelist"><code>PinCFlow.Types.NamelistTypes.TracerNamelist</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TracerNamelist{A &lt;: AbstractTracer, B &lt;: Bool, C &lt;: Function}</code></pre><p>Namelist for the inclusion of a tracer and the calculation of the leading-order gravity-wave impact.</p><pre><code class="language-julia hljs">TracerNamelist(;
    tracer_setup::AbstractTracer = NoTracer(),
    leading_order_impact::Bool = false,
    initial_tracer::Function = (x, y, z) -&gt; 0.0,
)::TracerNamelist</code></pre><p>Construct a <code>TracerNamelist</code> instance with the given keyword arguments as properties.</p><p><strong>Fields/Keywords</strong></p><ul><li><p><code>tracer_setup::A</code>: General tracer configuration.</p></li><li><p><code>leading_order_impact::B</code>: Flag to include the leading-order impact of gravity waves when parameterizing waves with the WKB model.</p></li><li><p><code>initial_tracer::C</code>: Function used to initialize the tracer.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.TracerOn" href="#PinCFlow.Types.NamelistTypes.TracerOn"><code>PinCFlow.Types.NamelistTypes.TracerOn</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TracerOn &lt;: AbstractTracer</code></pre><p>Singleton for model configurations with an initially linear tracer.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.UniformBoussinesq" href="#PinCFlow.Types.NamelistTypes.UniformBoussinesq"><code>PinCFlow.Types.NamelistTypes.UniformBoussinesq</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">UniformBoussinesq &lt;: AbstractBackground</code></pre><p>Singleton for a Boussinesq atmosphere without stratification.</p></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.NamelistTypes.WKBNamelist" href="#PinCFlow.Types.NamelistTypes.WKBNamelist"><code>PinCFlow.Types.NamelistTypes.WKBNamelist</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WKBNamelist{
    A &lt;: Integer,
    B &lt;: AbstractFloat,
    C &lt;: AbstractMergeMode,
    D &lt;: Bool,
    E &lt;: AbstractWKBFilter,
    F &lt;: AbstractWKBMode,
    G &lt;: Function,
}</code></pre><p>Namelist for parameters used by MSGWaM.</p><pre><code class="language-julia hljs">WKBNamelist(;
    nrx::Integer = 1,
    nry::Integer = 1,
    nrz::Integer = 1,
    nrk::Integer = 1,
    nrl::Integer = 1,
    nrm::Integer = 1,
    multiplication_factor::Integer = 4,
    dkr_factor::AbstractFloat = 1.0E-1,
    dlr_factor::AbstractFloat = 1.0E-1,
    dmr_factor::AbstractFloat = 1.0E-1,
    branch::Integer = -1,
    merge_mode::AbstractMergeMode = ConstantWaveAction(),
    filter_order::Integer = 2,
    smooth_tendencies::Bool = true,
    filter_type::AbstractWKBFilter = Shapiro(),
    impact_altitude::AbstractFloat = 0.0E+0,
    use_saturation::Bool = true,
    saturation_threshold::AbstractFloat = 1.0E+0,
    wkb_mode::AbstractWKBMode = NoWKB(),
    blocking::Bool = false,
    long_threshold::AbstractFloat = 2.5E-1,
    drag_coefficient::AbstractFloat = 1.0E+0,
    wave_modes::Integer = 1,
    initial_wave_field::Function = (alpha, x, y, z) -&gt;
        (0.0, 0.0, 0.0, 0.0, 0.0),
)::WKBNamelist</code></pre><p>Construct a <code>WKBNamelist</code> instance with the given keyword arguments as properties.</p><p><strong>Fields/Keywords</strong></p><ul><li><p><code>nrx::A</code>: Number of ray-volumes launched per grid cell and wave mode in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>nry::A</code>: Number of ray-volumes launched per grid cell and wave mode in <span>$\widehat{y}$</span>-direction.</p></li><li><p><code>nrz::A</code>: Number of ray-volumes launched per grid cell and wave mode in <span>$\widehat{z}$</span>-direction.</p></li><li><p><code>nrk::A</code>: Number of ray-volumes launched per grid cell and wave mode in <span>$k$</span>-direction.</p></li><li><p><code>nrl::A</code>: Number of ray-volumes launched per grid cell and wave mode in <span>$l$</span>-direction.</p></li><li><p><code>nrm::A</code>: Number of ray-volumes launched per grid cell and wave mode in <span>$m$</span>-direction.</p></li><li><p><code>multiplication_factor::A</code>: Factor by which ray volumes are allowed to multiply in each dimension of physical space.</p></li><li><p><code>dkr_factor::B</code>: Relative initial ray-volume extent in <span>$k$</span>.</p></li><li><p><code>dlr_factor::B</code>: Relative initial ray-volume extent in <span>$l$</span>.</p></li><li><p><code>dmr_factor::B</code>: Relative initial ray-volume extent in <span>$m$</span>.</p></li><li><p><code>branch::A</code>: Frequency branch.</p></li><li><p><code>merge_mode::C</code>: Ray-volume merging strategy (conserved quantity).</p></li><li><p><code>filter_order::A</code>: Order of the smoothing applied to the mean-flow tendencies.</p></li><li><p><code>smooth_tendencies::D</code>: Switch for smoothing the mean-flow tendencies.</p></li><li><p><code>filter_type::E</code>: Filter to use for the smoothing of the mean-flow tendencies.</p></li><li><p><code>impact_altitude::B</code>: Minimum altitude for ray-tracing and mean-flow impact.</p></li><li><p><code>use_saturation::D</code>: Switch for the saturation scheme.</p></li><li><p><code>saturation_threshold::B</code>: Relative saturation threshold.</p></li><li><p><code>wkb_mode::F</code>: Approximations used by MSGWaM.</p></li><li><p><code>blocking::D</code>: Switch for parameterizing blocking in WKB-mountain-wave simulations.</p></li><li><p><code>long_threshold::B</code>: Long-number threshold used by the blocked-layer scheme.</p></li><li><p><code>drag_coefficient::B</code>: Dimensionless (relative) drag coefficient used by the blocked layer scheme.</p></li><li><p><code>wave_modes::A</code>: Number of wave modes per grid cell.</p></li><li><p><code>initial_wave_field::G</code>: Function used to set the initial wavenumbers, intrinsic frequency and wave-action density of each wave mode.</p></li></ul></div></section></article><h2 id="FoundationalTypes"><a class="docs-heading-anchor" href="#FoundationalTypes">FoundationalTypes</a><a id="FoundationalTypes-1"></a><a class="docs-heading-anchor-permalink" href="#FoundationalTypes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes" href="#PinCFlow.Types.FoundationalTypes"><code>PinCFlow.Types.FoundationalTypes</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FoundationalTypes</code></pre><p>Module that contains the composite types <code>Time</code>, <code>Constants</code>, <code>Domain</code>, <code>Grid</code>, <code>Atmosphere</code> and <code>Sponge</code>.</p><p><strong>See also</strong></p><ul><li><a href="#PinCFlow.Types.NamelistTypes"><code>PinCFlow.Types.NamelistTypes</code></a></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes.Atmosphere" href="#PinCFlow.Types.FoundationalTypes.Atmosphere"><code>PinCFlow.Types.FoundationalTypes.Atmosphere</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Atmosphere{A &lt;: AbstractArray{&lt;:AbstractFloat, 3}}</code></pre><p>Composite type for atmospheric background fields.</p><pre><code class="language-julia hljs">Atmosphere(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    grid::Grid,
)::Atmosphere</code></pre><p>Create an <code>Atmosphere</code> instance by dispatching to a method specific for the background and dynamic equations set in <code>namelists</code>.</p><pre><code class="language-julia hljs">Atmosphere(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    grid::Grid,
    model::Boussinesq,
    background::UniformBoussinesq,
)::Atmosphere</code></pre><p>Create an <code>Atmosphere</code> instance with background fields describing a uniform (i.e. neutral) Boussinesq atmosphere.</p><p>The background fields are given by</p><p class="math-container">\[\begin{align*}
    \overline{\rho} &amp; = \rho_0, &amp; \overline{\theta} &amp; = \theta_0, &amp; P &amp; = \overline{\rho} \overline{\theta}, &amp; N^2 &amp; = 0,
\end{align*}\]</p><p>where <span>$\rho_0$</span> and <span>$\theta_0$</span> are given by <code>constants.rhoref</code> and <code>namelists.atmosphere.potential_temperature</code>, respectively.</p><pre><code class="language-julia hljs">Atmosphere(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    grid::Grid,
    model::Boussinesq,
    background::StratifiedBoussinesq,
)::Atmosphere</code></pre><p>Create an <code>Atmosphere</code> instance with background fields describing a stratified Boussinesq atmosphere.</p><p>The background fields are given by</p><p class="math-container">\[\begin{align*}
    \overline{\rho} &amp; = \rho_0, &amp; \overline{\theta} &amp; = \theta_0, &amp; P &amp; = \overline{\rho} \overline{\theta}, &amp; N^2 &amp; = N_0^2,
\end{align*}\]</p><p>where <span>$\rho_0$</span>, <span>$\theta_0$</span> and <span>$N_0$</span> are given by <code>constants.rhoref</code>, <code>namelists.atmosphere.potential_temperature</code> and <code>namelists.atmosphere.buoyancy_frequency</code>, respectively.</p><pre><code class="language-julia hljs">Atmosphere(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    grid::Grid,
    model::Union{PseudoIncompressible, Compressible},
    background::Isothermal,
)::Atmosphere</code></pre><p>Create an <code>Atmosphere</code> instance with background fields describing an isothermal atmosphere.</p><p>The background fields are given by</p><p class="math-container">\[\begin{align*}
    P \left(z\right) &amp; = p_0 \exp \left(- \frac{\sigma z}{\gamma T_0}\right),\\
    \overline{\theta} \left(z\right) &amp; = T_0 \exp \left(\frac{\kappa \sigma z}{T_0}\right),\\
    \overline{\rho} \left(z\right) &amp; = \frac{P \left(z\right)}{\overline{\theta} \left(z\right)},\\
    N^2 &amp; = \frac{g}{\overline{\theta}} \frac{\overline{\theta}_{k + 1} - \overline{\theta}_{k - 1}}{2 J \Delta \widehat{z}},
\end{align*}\]</p><p>where <span>$p_0$</span>, <span>$T_0$</span>, <span>$\sigma$</span>, <span>$\gamma$</span> and <span>$\kappa$</span> are given by <code>namelists.atmosphere.ground_pressure</code>, <code>namelists.atmosphere.temperature</code>, <code>constants.sig</code>, <code>constants.gamma</code> and <code>constants.kappa</code>, respectively.</p><pre><code class="language-julia hljs">Atmosphere(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    grid::Grid,
    model::Union{PseudoIncompressible, Compressible},
    background::Isentropic,
)::Atmosphere</code></pre><p>Create an <code>Atmosphere</code> instance with background fields describing an isentropic atmosphere.</p><p>The background fields are given by</p><p class="math-container">\[\begin{align*}
    P \left(z\right) &amp; = p_0 \left( 1 - \frac{\kappa\sigma z}{\theta_0}\right)^{\frac{1}{\gamma - 1}} \;, \\
    \overline{\theta} &amp; = \theta_0 \;, \\
    \overline{\rho}\left(z\right) &amp; = \frac{P \left(z\right)}{\overline{\theta} \left(z\right)}\;,\\
    N^2 &amp; = 0 \;,
\end{align*}\]</p><p>where <span>$p_0$</span>, <span>$\theta_0$</span>, <span>$\sigma$</span>, <span>$\gamma$</span> and <span>$\kappa$</span> are given by <code>namelists.atmosphere.ground_pressure</code>, <code>namelists.atmosphere.potential_temperature</code>, <code>constants.sig</code>, <code>constants.gamma</code> and <code>constants.kappa</code>, respectively.</p><pre><code class="language-julia hljs">Atmosphere(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    grid::Grid,
    model::Union{PseudoIncompressible, Compressible},
    background::Realistic,
)::Atmosphere</code></pre><p>Create an <code>Atmosphere</code> instance with background fields describing a realistic atmosphere with an isentropic troposphere, an isothermal stratosphere, and a tropopause located at the altitude <span>$z_{\mathrm{TP}}$</span>.</p><p>The background fields are given by</p><p class="math-container">\[\begin{align*}
    P \left(z \right) &amp; =
    \begin{cases}
        p_0 \left( 1 - \frac{\kappa\sigma z}{\theta_0}\right)^{\frac{1}{\gamma - 1}} &amp; z \leq z_{\mathrm{TP}}\;, \\
        p_0^{\kappa} p_{\mathrm{TP}}^{1/\gamma}\exp\left[-\frac{\sigma(z-z_{\mathrm{TP}})}{\gamma T_{\mathrm{TP}}}\right] &amp; z &gt; z_{\mathrm{TP}} \;,
    \end{cases} \\
    \overline{\theta}\left(z\right) &amp; =
    \begin{cases}
        \theta_0 &amp; z \leq z_{\mathrm{TP}} \;, \\
        \theta_0 \exp\left[\frac{\kappa\sigma(z-z_{\mathrm{TP}})}{T_{\mathrm{TP}}}\right] &amp; z &gt; z_{\mathrm{TP}} \;,
    \end{cases} \\
    \overline{\rho}\left(z\right) &amp; = \frac{P \left(z\right)}{\overline{\theta} \left(z\right)}\;,\\
    N^2 &amp; = \frac{g}{\overline{\theta}} \frac{\overline{\theta}_{k + 1} - \overline{\theta}_{k - 1}}{2 J \Delta \widehat{z}}\;,
\end{align*}\]</p><p>where</p><p class="math-container">\[\begin{align*}
    p_{\mathrm{TP}} &amp; = p_0 \left(1 - \frac{\kappa\sigma z_{\mathrm{TP}}}{\theta_0}\right)^{\frac{1}{\gamma - 1}} \;, \\
    T_{\mathrm{TP}} &amp; = \theta_0 \left(\frac{p_{\mathrm{TP}}}{p_0}\right)^{\kappa}\;,
\end{align*}\]</p><p>and <span>$p_0$</span>, <span>$\theta_0$</span>, <span>$z_{\mathrm{TP}}$</span>, <span>$\sigma$</span>, <span>$\gamma$</span>, and <span>$\kappa$</span> are given by <code>namelists.atmosphere.ground_pressure</code>, <code>namelists.atmosphere.potential_temperature</code>, <code>namelists.atmosphere.tropopause_height</code>, <code>constants.sig</code>, <code>constants.gamma</code>, and <code>constants.kappa</code>, respectively.</p><pre><code class="language-julia hljs">Atmosphere(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    grid::Grid,
    model::Union{PseudoIncompressible, Compressible},
    background::LapseRates,
)::Atmosphere</code></pre><p>Create an <code>Atmosphere</code> instance with background fields describing a troposphere and a stratosphere with lapse rates <span>$\Gamma_{\mathrm{TS}}$</span> and <span>$\Gamma_{\mathrm{TS}}$</span>, respectively, and a tropopause located at the altitude <span>$z_{\mathrm{TP}}$</span>.</p><p>The background fields are given by</p><p class="math-container">\[\begin{align*}
    T\left(z\right) &amp; =
    \begin{cases}
        T_0 - \Gamma_{\mathrm{TS}} z &amp; z \leq z_{\mathrm{TP}} \;, \\
        T_0 - \Gamma_{\mathrm{TS}} z_{\mathrm{TP}} - \Gamma_{\mathrm{SS}} \left(z - z_{\mathrm{TP}}\right) &amp; z &gt; z_{\mathrm{TP}} \;,
    \end{cases} \\
    P\left(z\right) &amp; =
    \begin{cases}
        p_0 \left(1 - \frac{\Gamma_{\mathrm{TS}} z}{T_0}\right)^{\frac{g}{R \Gamma_{\mathrm{TS}}}} &amp; z \leq z_{\mathrm{TP}} \; \&amp; \; \Gamma_{\mathrm{TS}} \neq 0 \;, \\
        p_0 \exp\left(- \frac{z \sigma}{\gamma T_0} \right) &amp; z \leq z_{\mathrm{TP}} \; \&amp; \; \Gamma_{\mathrm{TS}} = 0 \;, \\
        p_{\mathrm{TP}}\left[1 - \frac{\Gamma_{\mathrm{SS}} \left(z - z_{\mathrm{TP}} \right)}{T_{\mathrm{TP}}} \right]^{\frac{g}{R\Gamma_{\mathrm{SS}}}} &amp; z &gt; z_{\mathrm{TP}} \; \&amp; \; \Gamma_{\mathrm{SS}} \neq 0 \;, \\
        p_{\mathrm{TP}}\exp\left[- \frac{\left(z - z_{\mathrm{TP}} \right)\sigma}{\gamma T_{\mathrm{TP}}} \right] &amp; z &gt; z_{\mathrm{TP}} \; \&amp; \; \Gamma_{\mathrm{SS}} = 0 \;,
    \end{cases} \\
    \overline{\theta}\left(z\right) &amp; =
    \begin{cases}
        T\left(z\right) \left[\frac{p_0}{P\left(z\right)}\right]^{\frac{R\Gamma_{\mathrm{TS}}}{g}} &amp; z \leq z_{\mathrm{TP}} \; \&amp; \; \Gamma_{\mathrm{TS}} \neq 0 \;, \\
        T_0 \exp\left(\frac{\kappa\sigma z}{T_0}\right) &amp; z \leq z_{\mathrm{TP}} \;\&amp;\; \Gamma_{\mathrm{TS}} = 0 \;, \\
        T\left(z\right)\left[\frac{p_{\mathrm{TP}}}{P\left(z\right)}\right]^{\frac{R\Gamma_{\mathrm{SS}}}{g}} &amp; z &gt; z_{\mathrm{TP}} \; \&amp; \; \Gamma_{\mathrm{SS}} \neq 0 \;, \\
        \theta_{\mathrm{TP}}\exp\left[\frac{\kappa\sigma \left(z-z_{\mathrm{TP}}\right)}{T\left(z_{\mathrm{TP}}\right)}\right] &amp; z &gt; z_{\mathrm{TP}} \;\&amp;\; \Gamma_{\mathrm{SS}} = 0 \;,
    \end{cases} \\
    \overline{\rho}\left(z\right) &amp; = \frac{P \left(z\right)}{\overline{\theta} \left(z\right)}\;,\\
    N^2 &amp; = \frac{g}{\overline{\theta}} \frac{\overline{\theta}_{k + 1} - \overline{\theta}_{k - 1}}{2 J \Delta \widehat{z}}\;,
\end{align*}\]</p><p>where</p><p class="math-container">\[\begin{align*}
    p_{\mathrm{TP}} &amp; =
    \begin{cases}
        p_0 \left(1 - \frac{\Gamma_{\mathrm{TS}} z_{\mathrm{TP}}}{T_0}\right)^{\frac{g}{R \Gamma_{\mathrm{TS}}}} &amp; \Gamma_{\mathrm{TS}} \neq 0 \;, \\
        p_0 \exp\left(- \frac{z_{\mathrm{TP}}\sigma}{\gamma T_0} \right) &amp; \Gamma_{\mathrm{TS}} = 0 \;,
    \end{cases} \\
    \theta_{\mathrm{TP}} &amp;= T_0 \exp\left(\frac{\kappa\sigma z_{\mathrm{TP}}}{T_0} \right)\;,
\end{align*}\]</p><p>and <span>$p_0$</span>, <span>$T_0$</span>, <span>$z_{\mathrm{TP}}$</span>, <span>$\Gamma_{\mathrm{TS}}$</span>, <span>$\Gamma_{\mathrm{SS}}$</span>, <span>$\sigma$</span>, <span>$\gamma$</span>, and <span>$\kappa$</span> are given by <code>namelists.atmosphere.ground_pressure</code>, <code>namelists.atmosphere.temperature</code>, <code>namelists.atmosphere.tropopause_height</code>, <code>namelists.atmosphere.troposphere_lapse_rate</code>, <code>namelists.atmosphere.stratosphere_lapse_rate</code>, <code>constants.sig</code>, <code>constants.gamma</code>, and <code>constants.kappa</code>, respectively.</p><p><strong>Fields</strong></p><ul><li><p><code>pbar::A</code>: Mass-weighted potential temperature <span>$P \left(z\right)$</span> (<span>$P \left(x, y, z, t\right)$</span> in compressible mode).</p></li><li><p><code>thetabar::A</code>: Background potential temperature <span>$\overline{\theta} \left(z\right)$</span>.</p></li><li><p><code>rhobar::A</code>: Background density <span>$\overline{\rho} \left(z\right)$</span>.</p></li><li><p><code>n2::A</code>: Squared buoyancy frequency <span>$N^2 \left(z\right)$</span>.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>constants</code>: Physical constants and reference values.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>grid</code>: Collection of parameters and fields that describe the grid.</p></li><li><p><code>model</code>: Dynamic equations.</p></li><li><p><code>background</code>: Atmospheric background.</p></li></ul><p><strong>See also</strong></p><ul><li><a href="#PinCFlow.Types.FoundationalTypes.compute_n2!"><code>PinCFlow.Types.FoundationalTypes.compute_n2!</code></a></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes.Constants" href="#PinCFlow.Types.FoundationalTypes.Constants"><code>PinCFlow.Types.FoundationalTypes.Constants</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Constants{A &lt;: AbstractFloat}</code></pre><p>Composite type for natural constants, reference quantities and non-dimensional parameters.</p><pre><code class="language-julia hljs">Constants(namelists::Namelists)::Constants</code></pre><p>Create a <code>Constants</code> instance.</p><p>The Reynolds number is the only constant that depends on the model parameters in <code>namelists</code>. If <code>namelists.atmosphere.specify_reynolds_number</code> is <code>false</code>, the Reynolds number is <span>$\mathrm{Re} = L_\mathrm{ref} u_\mathrm{ref} / \mu$</span>, with <span>$\mu$</span> being the kinematic viscosity at the surface, given by <code>namelists.atmosphere.kinematic_viscosity</code>. Otherwise, it is set to the inverse of <code>namelists.atmosphere.inverse_reynolds_number</code>.</p><p><strong>Fields</strong></p><p>Natural constants:</p><ul><li><p><code>gamma::A</code>: Ratio of specific heats <span>$\gamma = c_p / c_V = 1.4$</span>.</p></li><li><p><code>gammainv::A</code>: Inverse ratio of specific heats <span>$1 / \gamma$</span>.</p></li><li><p><code>kappa::A</code>: Ratio between specific gas constant and specific heat capacity at constant pressure <span>$\kappa = \left(\gamma - 1\right) / \gamma = R / c_p = 2 / 7$</span>.</p></li><li><p><code>kappainv::A</code>: Ratio between specific heat capacity at constant pressure and specific gas constant <span>$1 / \kappa$</span>.</p></li><li><p><code>rsp::A</code>: Specific gas constant <span>$R = 287 \, \mathrm{J \, kg^{- 1} \, K^{- 1}}$</span>.</p></li><li><p><code>g::A</code>: Gravitational acceleration <span>$g = 9.81 \, \mathrm{m \, s^{- 2}}$</span>.</p></li></ul><p>Reference quantities:</p><ul><li><p><code>rhoref::A</code>: Reference density <span>$\rho_\mathrm{ref} = 1.184 \, \mathrm{kg \, m^{- 3}}$</span>.</p></li><li><p><code>pref::A</code>: Reference pressure <span>$p_\mathrm{ref} = 101325 \, \mathrm{Pa}$</span>.</p></li><li><p><code>aref::A</code>: Reference sound speed <span>$c_\mathrm{ref} = \sqrt{p_\mathrm{ref} / \rho_\mathrm{ref}}$</span>.</p></li><li><p><code>uref::A</code>: Reference wind <span>$u_\mathrm{ref} = a_\mathrm{ref}$</span>.</p></li><li><p><code>lref::A</code>: Reference length <span>$L_\mathrm{ref} = p_\mathrm{ref} /\left(g \rho_\mathrm{ref}\right)$</span>.</p></li><li><p><code>tref::A</code>: Reference time <span>$t_\mathrm{ref} = L_\mathrm{ref} / a_\mathrm{ref}$</span>.</p></li><li><p><code>thetaref::A</code>: Reference potential temperature <span>$\theta_\mathrm{ref} = a_\mathrm{ref}^2 / R$</span>.</p></li><li><p><code>fref::A</code>: Reference body force <span>$F_\mathrm{ref} = \rho_\mathrm{ref} u_\mathrm{ref}^2 / L_\mathrm{ref}$</span>.</p></li></ul><p>Non-dimensional parameters</p><ul><li><p><code>g_ndim::A</code>: Non-dimensional gravitational acceleration <span>$\widehat{g} = g L_\mathrm{ref} / u_\mathrm{ref}^2$</span>.</p></li><li><p><code>re::A</code>: Reynolds number <span>$\mathrm{Re} = L_\mathrm{ref} u_\mathrm{ref} / \mu$</span> (with <span>$\mu$</span> being the kinematic viscosity at the surface).</p></li><li><p><code>ma::A</code>: Mach number <span>$\mathrm{Ma} = u_\mathrm{ref} / a_\mathrm{ref}$</span>.</p></li><li><p><code>mainv2::A</code>: Inverse Mach number squared <span>$\mathrm{Ma}^{- 2}$</span>.</p></li><li><p><code>ma2::A</code>: Mach number squared <span>$\mathrm{Ma}^2$</span>.</p></li><li><p><code>fr::A</code>: Froude number <span>$\mathrm{Fr} = u_\mathrm{ref} / \sqrt{g L_\mathrm{ref}}$</span>.</p></li><li><p><code>frinv2::A</code>: Inverse Froude number squared <span>$\mathrm{Fr}^{- 2}$</span>.</p></li><li><p><code>fr2::A</code>: Froude number squared <span>$\mathrm{Fr}^{2}$</span>.</p></li><li><p><code>sig::A</code>: Ratio between squared Mach number and squared Froude number <span>$\sigma = \mathrm{Ma}^2 / \mathrm{Fr}^2$</span>.</p></li></ul><p><strong>Arguments</strong></p><ul><li><code>namelists</code>: Namelists with all model parameters.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes.Domain" href="#PinCFlow.Types.FoundationalTypes.Domain"><code>PinCFlow.Types.FoundationalTypes.Domain</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Domain{A &lt;: MPI.Comm, B &lt;: Bool, C &lt;: Integer}</code></pre><p>Collection of domain-decomposition and MPI-communication parameters.</p><pre><code class="language-julia hljs">Domain(namelists::Namelists)::Domain</code></pre><p>Construct a <code>Domain</code> instance from the model parameters in <code>namelists</code>.</p><p>If <code>namelists.domain.base_comm</code> is equal to <code>MPI.COMM_WORLD</code>, this method first initializes the MPI parallelization by calling <code>MPI.Init()</code>. It then creates a Cartesian topology from the base communicator, with periodic boundaries in the first two dimensions (<span>$\widehat{x}$</span> and <span>$\widehat{y}$</span>) but not in the last (<span>$\widehat{z}$</span>). The domain is divided into corresponding subdomains, where in each direction, the number of grid points (<code>nx</code>, <code>ny</code> and <code>nz</code>) is the result of floor division of the global grid size (<code>namelists.domain.x_size</code>, <code>namelists.domain.y_size</code> and <code>namelists.domain.z_size</code>) by the number of processes in that direction (<code>namelists.domain.npx</code>, <code>namelists.domain.npy</code> and <code>namelists.domain.npz</code>). The remainder of the floor division is included in the grid-point count of the last processes (in each direction). The index bounds (<code>(i0, i1)</code>, <code>(j0, j1)</code> and <code>(k0, k1)</code>) are set such that they exclude the first and last <code>namelists.domain.nbx</code>, <code>namelists.domain.nby</code> and <code>namelists.domain.nbz</code> cells in <span>$\widehat{x}$</span>, <span>$\widehat{y}$</span> and <span>$\widehat{z}$</span>, respectively (these are not included in <code>nx</code>, <code>ny</code> and <code>nz</code>).</p><p><strong>Fields</strong></p><p>General MPI communication:</p><ul><li><p><code>comm::A</code>: MPI communicator with Cartesian topology for the computational domain.</p></li><li><p><code>master::B</code>: Boolean flag indicating if this process is the master process (rank 0).</p></li><li><p><code>rank::C</code>: MPI rank of this process within the communicator <code>comm</code>.</p></li><li><p><code>root::C</code>: Root process rank (0).</p></li></ul><p>Dimensions of the MPI subdomain:</p><ul><li><p><code>nx::C</code>: Number of physical grid points in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>ny::C</code>: Number of physical grid points in <span>$\widehat{y}$</span>-direction.</p></li><li><p><code>nz::C</code>: Number of physical grid points in <span>$\widehat{z}$</span>-direction.</p></li><li><p><code>nxx::C</code>: Number of computational grid points in <span>$\widehat{x}$</span>-direction (including halo/boundary cells).</p></li><li><p><code>nyy::C</code>: Number of computational grid points in <span>$\widehat{y}$</span>-direction (including halo/boundary cells).</p></li><li><p><code>nzz::C</code>: Number of computational grid points in <span>$\widehat{z}$</span>-direction (including halo/boundary cells).</p></li></ul><p>Dimensions of the entire domain:</p><ul><li><p><code>xx_size::C</code>: Number of computational grid points in <span>$\widehat{x}$</span>-direction (including halo/boundary cells).</p></li><li><p><code>yy_size::C</code>: Number of computational grid points in <span>$\widehat{y}$</span>-direction (including halo/boundary cells).</p></li><li><p><code>zz_size::C</code>: Number of computational grid points in <span>$\widehat{z}$</span>-direction (including halo/boundary cells).</p></li></ul><p>Index offsets and bounds:</p><ul><li><p><code>io::C</code>: MPI offset in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>jo::C</code>: MPI offset in <span>$\widehat{y}$</span>-direction.</p></li><li><p><code>ko::C</code>: MPI offset in <span>$\widehat{z}$</span>-direction.</p></li><li><p><code>i0::C</code>: First physical grid cell of the subdomain in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>i1::C</code>: Last physical grid cell of the subdomain in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>j0::C</code>: First physical grid cell of the subdomain in <span>$\widehat{y}$</span>-direction.</p></li><li><p><code>j1::C</code>: Last physical grid cell of the subdomain in <span>$\widehat{y}$</span>-direction.</p></li><li><p><code>k0::C</code>: First physical grid cell of the subdomain in <span>$\widehat{z}$</span>-direction.</p></li><li><p><code>k1::C</code>: Last physical grid cell of the subdomain in <span>$\widehat{z}$</span>-direction.</p></li></ul><p>Neighbor-process ranks:</p><ul><li><p><code>left::C</code>: Rank of the next process to the left (negative <span>$x$</span>-direction).</p></li><li><p><code>right::C</code>: Rank of the next process to the right (positive <span>$x$</span>-direction).</p></li><li><p><code>backward::C</code>: Rank of the next process to the back (negative <span>$y$</span>-direction).</p></li><li><p><code>forward::C</code>: Rank of the next process to the front (positive <span>$y$</span>-direction).</p></li><li><p><code>down::C</code>: Rank of the next process to the bottom (negative <span>$z$</span>-direction).</p></li><li><p><code>up::C</code>: Rank of the next process to the top (positive <span>$z$</span>-direction).</p></li></ul><p>Horizontal and vertical communication:</p><ul><li><p><code>layer_comm::A</code>: MPI communicator for processes in the same layer (i.e. with the same vertical index).</p></li><li><p><code>column_comm::A</code>: MPI communicator for processes in the same column (i.e. with the same horizontal indices).</p></li></ul><p><strong>Arguments</strong></p><ul><li><code>namelists</code>: Namelists with all model parameters.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes.Grid" href="#PinCFlow.Types.FoundationalTypes.Grid"><code>PinCFlow.Types.FoundationalTypes.Grid</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Grid{
    A &lt;: AbstractFloat,
    B &lt;: AbstractVector{&lt;:AbstractFloat},
    C &lt;: AbstractMatrix{&lt;:AbstractFloat},
    D &lt;: AbstractArray{&lt;:AbstractFloat, 3},
    E &lt;: AbstractArray{&lt;:AbstractFloat, 3},
    F &lt;: AbstractArray{&lt;:AbstractFloat, 5},
}</code></pre><p>Collection of parameters and fields that describe the grid.</p><pre><code class="language-julia hljs">Grid(namelists::Namelists, constants::Constants, domain::Domain)::Grid</code></pre><p>Construct a <code>Grid</code> instance, using the specifications in <code>namelists.grid</code> and the MPI decomposition described by <code>domain</code>.</p><p>This constructor creates a 3D parallelized grid for a terrain-following, vertically stretched coordinate system. The global computational grid is defined by</p><p class="math-container">\[\begin{align*}
    \widehat{x}_i &amp; = - L_x / 2 + \left(i - i_0 + \frac{1}{2}\right) \Delta \widehat{x},\\
    \widehat{y}_j &amp; = - L_y / 2 + \left(j - j_0 + \frac{1}{2}\right) \Delta \widehat{y},\\
    \widehat{z}_k &amp; = \left(k - k_0 + \frac{1}{2}\right) \Delta \widehat{z},\\
\end{align*}\]</p><p>where <span>$\left(L_x, L_y\right)$</span>, <span>$\left(i_0, j_0, k_0\right)$</span> and <span>$\left(\Delta \widehat{x}, \Delta \widehat{y}, \Delta \widehat{z}\right)$</span> are the horizontal extents of the domain, the lower index bounds of the MPI subdomains and the grid spacings (determined from the total extents and grid-point counts of the domain), respectively. Throughout the documentation, the position of any variable on this grid is indicated with the indices <span>$\left(i, j, k\right)$</span> in its subscript. Therein, unshifted indices are omitted for the sake of brevity. The grid is staggered, i.e. the wind components are defined at the midpoints of those cell surfaces that are orthogonal to their respective directions. Interpolations are therefore necessary in many places. These are indicated as in</p><p class="math-container">\[\begin{align*}
    \rho_{i + 1 / 2} &amp; = \frac{\rho + \rho_{i + 1}}{2}, &amp; \rho_{j + 1 / 2} &amp; = \frac{\rho + \rho_{j + 1}}{2}, &amp; \rho_{k + 1 / 2} &amp; = \frac{J_{k + 1} \rho + J \rho_{k + 1}}{J_{k + 1} + J},\\
    u &amp; = \frac{u_{i - 1 / 2} + u_{i + 1 / 2}}{2}, &amp; u_{j + 1 / 2} &amp; = \frac{u + u_{j + 1}}{2}, &amp; u_{k + 1 / 2} &amp; = \frac{J_{k + 1} u + J u_{k + 1}}{J_{k + 1} + J},\\
    v_{i + 1 / 2} &amp; = \frac{v + v_{i + 1}}{2}, &amp; v &amp; = \frac{v_{j - 1 / 2} + v_{j + 1 / 2}}{2}, &amp; v_{k + 1 / 2} &amp; = \frac{J_{k + 1} v + J v_{k + 1}}{J_{k + 1} + J},\\
    \widehat{w}_{i + 1 / 2} &amp; = \frac{\widehat{w} + \widehat{w}_{i + 1}}{2}, &amp; \widehat{w}_{j + 1 / 2} &amp; = \frac{\widehat{w} + \widehat{w}_{j + 1}}{2}, &amp; \widehat{w} &amp; = \frac{\widehat{w}_{k - 1 / 2} + \widehat{w}_{k + 1 / 2}}{2}.
\end{align*}\]</p><p>The vertical layer centers and edges of the stretched and physical grids are given by</p><p class="math-container">\[\begin{align*}
    \widetilde{z}_{k + 1 / 2} &amp; = L_z \left(\frac{\widehat{z}_{k + 1 / 2}}{L_z}\right)^s, &amp; z_{k + 1 / 2} &amp; = \frac{L_z - h}{L_z} \widetilde{z}_{k + 1 / 2} + h,\\
    \widetilde{z} &amp; = \frac{\widetilde{z}_{k + 1 / 2} + \widetilde{z}_{k - 1 / 2}}{2}, &amp; z &amp; = \frac{L_z - h}{L_z} \widetilde{z} + h,
\end{align*}\]</p><p>where <span>$L_z$</span>, <span>$s$</span> and <span>$h$</span> are the vertical extent of the domain (<code>namelists.domain.lz</code>), the vertical-stretching parameter (<code>namelists.grid.stretch_exponent</code>) and the surface topography (as returned by <code>compute_topography</code>), respectively. Finally, the Jacobian is</p><p class="math-container">\[J = \frac{L_z - h}{L_z} \frac{\widetilde{z}_{k + 1 / 2} - \widetilde{z}_{k - 1 / 2}}{\Delta \widehat{z}}\]</p><p>and the non-Cartesian elements of the metric tensor are</p><p class="math-container">\[\begin{align*}
    G^{1 3} &amp; = \frac{h_{\mathrm{b}, i + 1} - h_{\mathrm{b}, i - 1}}{2 \Delta \widehat{x}} \frac{\widetilde{z} - L_z}{L_z - h} \frac{\Delta \widehat{z}}{\widetilde{z}_{k + 1 / 2} - \widetilde{z}_{k - 1 / 2}},\\
    G^{2 3} &amp; = \frac{h_{\mathrm{b}, j + 1} - h_{\mathrm{b}, j - 1}}{2 \Delta \widehat{y}} \frac{\widetilde{z} - L_z}{L_z - h} \frac{\Delta \widehat{z}}{\widetilde{z}_{k + 1 / 2} - \widetilde{z}_{k - 1 / 2}},\\
    G^{3 3} &amp; = \left\{\left(\frac{L_z}{L_z - h}\right)^2 + \left(\frac{\widetilde{z} - L_z}{L_z - h}\right)^2 \left[\left(\frac{h_{\mathrm{b}, i + 1} - h_{\mathrm{b}, i - 1}}{2 \Delta \widehat{x}}\right)^2 + \left(\frac{h_{\mathrm{b}, j + 1} - h_{\mathrm{b}, j - 1}}{2 \Delta \widehat{y}}\right)^2\right]\right\}\\
    &amp; \quad \times \left(\frac{\Delta \widehat{z}}{\widetilde{z}_{k + 1 / 2} - \widetilde{z}_{k - 1 / 2}}\right)^2.
\end{align*}\]</p><p><strong>Fields</strong></p><p>Domain extent:</p><ul><li><p><code>lx::A</code>: Non-dimensional domain extent in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>ly::A</code>: Non-dimensional domain extent in <span>$\widehat{y}$</span>-direction.</p></li><li><p><code>lz::A</code>: Non-dimensional domain extent in <span>$\widehat{z}$</span>-direction.</p></li></ul><p>Grid spacing:</p><ul><li><p><code>dx::A</code>: Grid spacing <span>$\Delta \widehat{x}$</span>.</p></li><li><p><code>dy::A</code>: Grid spacing <span>$\Delta \widehat{y}$</span>.</p></li><li><p><code>dz::A</code>: Grid spacing <span>$\Delta \widehat{z}$</span>.</p></li></ul><p>Horizontal coordinates:</p><ul><li><p><code>x::B</code>: Cell-centered <span>$\widehat{x}$</span>-coordinate of the entire domain.</p></li><li><p><code>y::B</code>: Cell-centered <span>$\widehat{y}$</span>-coordinate of the entire domain.</p></li></ul><p>Topography:</p><ul><li><p><code>hb::C</code>: Resolved surface topography.</p></li><li><p><code>hw::D</code>: Spectrum of the unresolved surface topography.</p></li><li><p><code>kh::D</code>: Zonal wavenumbers of the spectrum.</p></li><li><p><code>lh::D</code>: Meridional wavenumbers of the spectrum.</p></li></ul><p>Coordinate transformation.</p><ul><li><p><code>jac::E</code>: Jacobian.</p></li><li><p><code>met::F</code>: Metric tensor.</p></li></ul><p>Vertical coordinates:</p><ul><li><p><code>zc::E</code>: Physical height at cell centers.</p></li><li><p><code>zctilde::E</code>: Physical height at vertical cell edges.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>constants</code>: Physical constants and reference values.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li></ul><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.FoundationalTypes.compute_topography"><code>PinCFlow.Types.FoundationalTypes.compute_topography</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes.set_zonal_boundaries_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_zonal_boundaries_of_field!</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes.set_meridional_boundaries_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_meridional_boundaries_of_field!</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes.Sponge" href="#PinCFlow.Types.FoundationalTypes.Sponge"><code>PinCFlow.Types.FoundationalTypes.Sponge</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Sponge{
    A &lt;: AbstractArray{&lt;:AbstractFloat, 3},
    B &lt;: AbstractFloat,
    C &lt;: AbstractVector{&lt;:AbstractFloat},
}</code></pre><p>Composite type for Rayleigh-damping coefficients, sponge bounds and extents, as well as an auxiliary array for the computation of horizontal means.</p><pre><code class="language-julia hljs">Sponge(namelists::Namelists, domain::Domain, grid::Grid)::Sponge</code></pre><p>Construct a <code>Sponge</code> instance, using the model parameters in <code>namelists</code>.</p><p>The vertical extent of the sponge is set to the fraction <code>namelists.sponge.sponge_extent</code> of the vertical extent of the domain. The horizontal extents of the LHS sponge are computed similarly, using the same parameter multiplied by <code>0.5</code> (since the sponge is centered at the horizontal boundaries).</p><p><strong>Fields</strong></p><p>Rayleigh-damping coefficients:</p><ul><li><p><code>alphar::A</code>: Coefficient of the LHS sponge (used in all prognostic equations).</p></li><li><p><code>betar::A</code>: Coefficient of the RHS sponge (used in the momentum equation).</p></li></ul><p>Vertical sponge extent:</p><ul><li><p><code>zsponge::B</code>: Lower edge of both sponges.</p></li><li><p><code>dzsponge::B</code>: Vertical extent of both sponges.</p></li></ul><p>Horizontal sponge extent:</p><ul><li><p><code>xsponge0::B</code>: Right edge of the LHS sponge.</p></li><li><p><code>xsponge1::B</code>: Left edge of the LHS sponge.</p></li><li><p><code>ysponge0::B</code>: Forward edge of the LHS sponge.</p></li><li><p><code>ysponge1::B</code>: Backward edge of the LHS sponge.</p></li><li><p><code>dxsponge::B</code>: Halved zonal extent of the LHS sponge.</p></li><li><p><code>dysponge::B</code>: Halved meridional extent of the LHS sponge.</p></li></ul><p>Auxiliary array:</p><ul><li><code>horizontal_mean::C</code>: Auxiliary array for the computation of horizontal means.</li></ul><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>grid</code>: Collection of parameters and fields that describe the grid.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes.Time" href="#PinCFlow.Types.FoundationalTypes.Time"><code>PinCFlow.Types.FoundationalTypes.Time</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Time{A &lt;: Integer, B &lt;: NTuple{3, &lt;:AbstractFloat}}</code></pre><p>Time integration parameters for the low-storage third-order Runge-Kutta scheme.</p><pre><code class="language-julia hljs">Time()::Time</code></pre><p>Construct a <code>Time</code> instance.</p><p><strong>Fields</strong></p><ul><li><p><code>nstages::A</code>: Number of Runge-Kutta stages.</p></li><li><p><code>alphark::B</code>: Runge-Kutta coefficients for the total tendency, i.e. <span>$\boldsymbol{\alpha}_\mathrm{RK} = \left(0, - 5 / 9, - 153 / 128\right)$</span>.</p></li><li><p><code>betark::B</code>: Runge-Kutta coefficients for the previous tendency, i.e. <span>$\boldsymbol{\beta}_\mathrm{RK} = \left(1 / 3, 15 / 16, 8 / 15\right)$</span>.</p></li><li><p><code>stepfrac::B</code>: Time step fractions for each stage, i.e. <span>$\boldsymbol{f}_\mathrm{RK} = \left(1 / 3, 5 / 12, 1 / 4\right)$</span>.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes.compute_n2!" href="#PinCFlow.Types.FoundationalTypes.compute_n2!"><code>PinCFlow.Types.FoundationalTypes.compute_n2!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_n2!(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    grid::Grid,
    thetabar::AbstractArray{&lt;:AbstractFloat, 3},
    n2::AbstractArray{&lt;:AbstractFloat, 3},
)</code></pre><p>Compute the buoyancy frequency <span>$N^2 \left(z\right)$</span> from the potential temperature.</p><p>The squared buoyancy frequency is given by</p><p class="math-container">\[\begin{align*}
N^2 &amp; = \frac{g}{\overline{\theta}} \frac{\overline{\theta}_{k + 1} - \overline{\theta}_{k - 1}}{2 J \Delta \widehat{z}} \;.
\end{align*}\]</p><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>constants</code>: Physical constants and reference values.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>grid</code>: Collection of parameters and fields that describe the grid.</p></li><li><p><code>thetabar</code>: Potential-temperature background.</p></li><li><p><code>n2</code>: Squared buoyancy frequency.</p></li></ul><p><strong>See also</strong></p><ul><li><a href="#PinCFlow.Types.FoundationalTypes.set_vertical_boundaries_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_vertical_boundaries_of_field!</code></a></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes.compute_topography" href="#PinCFlow.Types.FoundationalTypes.compute_topography"><code>PinCFlow.Types.FoundationalTypes.compute_topography</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compute_topography(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    x::AbstractVector{&lt;:AbstractFloat},
    y::AbstractVector{&lt;:AbstractFloat},
)::Tuple{
    &lt;:AbstractMatrix{&lt;:AbstractFloat},
    &lt;:AbstractArray{&lt;:AbstractFloat, 3},
    &lt;:AbstractArray{&lt;:AbstractFloat, 3},
    &lt;:AbstractArray{&lt;:AbstractFloat, 3},
}</code></pre><p>Compute and return the topography by dispatching to a WKB-mode-specific method.</p><pre><code class="language-julia hljs">compute_topography(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    x::AbstractVector{&lt;:AbstractFloat},
    y::AbstractVector{&lt;:AbstractFloat},
    wkb_mode::Union{SteadyState, SingleColumn, MultiColumn},
)::Tuple{
    &lt;:AbstractMatrix{&lt;:AbstractFloat},
    &lt;:AbstractArray{&lt;:AbstractFloat, 3},
    &lt;:AbstractArray{&lt;:AbstractFloat, 3},
    &lt;:AbstractArray{&lt;:AbstractFloat, 3},
}</code></pre><p>Compute and return the topography for WKB configurations.</p><p>The arrays in the returned tuple represent (in order) the resolved topography, the amplitudes of the unresolved topography, the corresponding zonal wavenumbers and the corresponding meridional wavenumbers.</p><pre><code class="language-julia hljs">compute_topography(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    x::AbstractVector{&lt;:AbstractFloat},
    y::AbstractVector{&lt;:AbstractFloat},
    wkb_mode::NoWKB,
)::Tuple{
    &lt;:AbstractMatrix{&lt;:AbstractFloat},
    &lt;:AbstractArray{&lt;:AbstractFloat, 3},
    &lt;:AbstractArray{&lt;:AbstractFloat, 3},
    &lt;:AbstractArray{&lt;:AbstractFloat, 3},
}</code></pre><p>Compute and return the topography for non-WKB configurations.</p><p>The arrays representing the unresolved spectrum are set to have the size <code>(0, 0, 0)</code>. The topography is represented by the first array in the returned tuple.</p><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>constants</code>: Physical constants and reference values.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>x</code>: <span>$\widehat{x}$</span>-coordinate grid points.</p></li><li><p><code>y</code>: <span>$\widehat{y}$</span>-coordinate grid points.</p></li><li><p><code>wkb_mode</code>: Approximations used by MSGWaM.</p></li></ul><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.FoundationalTypes.set_zonal_boundaries_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_zonal_boundaries_of_field!</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes.set_meridional_boundaries_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_meridional_boundaries_of_field!</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes.set_meridional_boundaries_of_field!" href="#PinCFlow.Types.FoundationalTypes.set_meridional_boundaries_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_meridional_boundaries_of_field!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_meridional_boundaries_of_field!(
    field::AbstractMatrix{&lt;:AbstractFloat},
    namelists::Namelists,
    domain::Domain,
)</code></pre><p>Enforce meridional boundary conditions for a matrix.</p><p>Halo exchange is used for multi-process domains (<code>npy &gt; 1</code>), otherwise periodic boundaries are set by copying values from opposite domain edges.</p><pre><code class="language-julia hljs">set_meridional_boundaries_of_field!(
    field::AbstractArray{&lt;:Real, 3},
    namelists::Namelists,
    domain::Domain;
    layers::NTuple{3, &lt;:Integer} = (-1, -1, -1),
)</code></pre><p>Enforce meridional boundary conditions for a 3D array.</p><p>Halo exchange is used in the same manner as in the method for matrices.</p><pre><code class="language-julia hljs">set_meridional_boundaries_of_field!(
    field::AbstractArray{&lt;:AbstractFloat, 5},
    namelists::Namelists,
    domain::Domain;
    layers::NTuple{3, &lt;:Integer} = (-1, -1, -1),
)</code></pre><p>Enforce meridional boundary conditions for a 5D array.</p><p>Halo exchange is used in the same manner as in the methods for matrices and 3D arrays. The first three dimensions of the array are assumed to represent the dimensions of physical space.</p><p><strong>Arguments</strong></p><ul><li><p><code>field</code>: Input array.</p></li><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li></ul><p><strong>Keywords</strong></p><ul><li><code>layers</code>: The number of boundary layers in each dimension. Use <code>-1</code> for the default values from <code>namelists</code>.</li></ul><p><strong>See also</strong></p><ul><li><a href="../mpi_operations/#PinCFlow.MPIOperations.set_meridional_halos_of_field!"><code>PinCFlow.MPIOperations.set_meridional_halos_of_field!</code></a></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes.set_meridional_halos_of_field!" href="#PinCFlow.Types.FoundationalTypes.set_meridional_halos_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_meridional_halos_of_field!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_meridional_halos_of_field!(
    field::AbstractMatrix{&lt;:AbstractFloat},
    namelists::Namelists,
    domain::Domain,
)</code></pre><p>Exchange all meridional halo values of a matrix by performing bidirectional MPI communication between backward and forward neighbor processes.</p><pre><code class="language-julia hljs">set_meridional_halos_of_field!(
    field::AbstractArray{&lt;:Real, 3},
    namelists::Namelists,
    domain::Domain;
    layers::NTuple{3, &lt;:Integer} = (-1, -1, -1),
)</code></pre><p>Exchange a specified number of meridional halo values of a 3D array with an algorithm similar to that implemented in the method for matrices.</p><pre><code class="language-julia hljs">set_meridional_halos_of_field!(
    field::AbstractArray{&lt;:AbstractFloat, 5},
    namelists::Namelists,
    domain::Domain;
    layers::NTuple{3, &lt;:Integer} = (-1, -1, -1),
)</code></pre><p>Exchange a specified number of meridional halo values of a 5D array with an algorithm similar to that implemented in the method for 3D arrays.</p><p>The first three dimensions of the array are assumed to represent the dimensions of physical space.</p><p><strong>Arguments</strong></p><ul><li><p><code>field</code>: Input array.</p></li><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li></ul><p><strong>Keywords</strong></p><ul><li><code>layers</code>: The number of halo layers in each dimension. Use <code>-1</code> for the default values from <code>namelists</code>.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes.set_vertical_boundaries_of_field!" href="#PinCFlow.Types.FoundationalTypes.set_vertical_boundaries_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_vertical_boundaries_of_field!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_vertical_boundaries_of_field!(
    field::AbstractArray{&lt;:Real, 3},
    namelists::Namelists,
    domain::Domain,
    mode::Function;
    layers::NTuple{3, &lt;:Integer} = (-1, -1, -1),
    staggered = false,
)</code></pre><p>Enforce vertical boundary conditions for a 3D array (assuming solid-wall boundaries).</p><p>Halo exchange is used for multi-process domains (<code>npz &gt; 1</code>). Use <code>mode = +</code> (<code>mode = -</code>) for line-reflected (point-reflected) ghost-cell values.</p><pre><code class="language-julia hljs">set_vertical_boundaries_of_field!(
    field::AbstractArray{&lt;:AbstractFloat, 5},
    namelists::Namelists,
    domain::Domain;
    layers::NTuple{3, &lt;:Integer} = (-1, -1, -1),
)</code></pre><p>Exchange halo values of a 5D array if multiple processes are used in the vertical (<code>npz &gt; 1</code>).</p><p>This method is applied to reconstruction arrays. Vertical boundary conditions are not enforced for these but for the fluxes determined from them.</p><p><strong>Arguments</strong></p><ul><li><p><code>field</code>: Input array.</p></li><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>mode</code>: Method used for setting the boundary-cell values.</p></li></ul><p><strong>Keywords</strong></p><ul><li><p><code>layers</code>: The number of boundary layers in each dimension. Use <code>-1</code> for the default values from <code>namelists</code>.</p></li><li><p><code>staggered</code>: A switch for whether or not the field is on the staggered vertical grid.</p></li></ul><p><strong>See also</strong></p><ul><li><a href="../mpi_operations/#PinCFlow.MPIOperations.set_vertical_halos_of_field!"><code>PinCFlow.MPIOperations.set_vertical_halos_of_field!</code></a></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes.set_vertical_halos_of_field!" href="#PinCFlow.Types.FoundationalTypes.set_vertical_halos_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_vertical_halos_of_field!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_vertical_halos_of_field!(
    field::AbstractArray{&lt;:Real, 3},
    namelists::Namelists,
    domain::Domain;
    layers::NTuple{3, &lt;:Integer} = (-1, -1, -1),
)</code></pre><p>Exchange a specified number of vertical halo values of a 3D array by performing MPI communication between downward and upward neighbor processes.</p><p>Solid walls are assumed at the vertical boundaries of the domain. The corresponding ghost-cell values are not changed.</p><pre><code class="language-julia hljs">set_vertical_halos_of_field!(
    field::AbstractArray{&lt;:AbstractFloat, 5},
    namelists::Namelists,
    domain::Domain;
    layers::NTuple{3, &lt;:Integer} = (-1, -1, -1),
)</code></pre><p>Exchange a specified number of vertical halo values of a 5D array with an algorithm similar to that implemented in the above method.</p><p>The vertical domain boundaries are treated as described above. The first three dimensions of the array are assumed to represent the dimensions of physical space.</p><p><strong>Arguments</strong></p><ul><li><p><code>field</code>: Input array.</p></li><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li></ul><p><strong>Keywords</strong></p><ul><li><code>layers</code>: The number of halo layers in each dimension. Use <code>-1</code> for the default values from <code>namelists</code>.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes.set_zonal_boundaries_of_field!" href="#PinCFlow.Types.FoundationalTypes.set_zonal_boundaries_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_zonal_boundaries_of_field!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_zonal_boundaries_of_field!(
    field::AbstractMatrix{&lt;:AbstractFloat},
    namelists::Namelists,
    domain::Domain,
)</code></pre><p>Enforce zonal boundary conditions for a matrix.</p><p>Halo exchange is used for multi-process domains (<code>npx &gt; 1</code>), otherwise periodic boundaries are set by copying values from opposite domain edges.</p><pre><code class="language-julia hljs">set_zonal_boundaries_of_field!(
    field::AbstractArray{&lt;:Real, 3},
    namelists::Namelists,
    domain::Domain;
    layers::NTuple{3, &lt;:Integer} = (-1, -1, -1),
)</code></pre><p>Enforce zonal boundary conditions for a 3D array.</p><p>Halo exchange is used in the same manner as in the method for matrices.</p><pre><code class="language-julia hljs">set_zonal_boundaries_of_field!(
    field::AbstractArray{&lt;:AbstractFloat, 5},
    namelists::Namelists,
    domain::Domain;
    layers::NTuple{3, &lt;:Integer} = (-1, -1, -1),
)</code></pre><p>Enforce zonal boundary conditions for a 5D array.</p><p>Halo exchange is used in the same manner as in the methods for matrices and 3D arrays. The first three dimensions of the array are assumed to represent the dimensions of physical space.</p><p><strong>Arguments</strong></p><ul><li><p><code>field</code>: Input array.</p></li><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li></ul><p><strong>Keywords</strong></p><ul><li><code>layers</code>: The number of boundary layers in each dimension. Use <code>-1</code> for the default values from <code>namelists</code>.</li></ul><p><strong>See also</strong></p><ul><li><a href="../mpi_operations/#PinCFlow.MPIOperations.set_zonal_halos_of_field!"><code>PinCFlow.MPIOperations.set_zonal_halos_of_field!</code></a></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.FoundationalTypes.set_zonal_halos_of_field!" href="#PinCFlow.Types.FoundationalTypes.set_zonal_halos_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_zonal_halos_of_field!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_zonal_halos_of_field!(
    field::AbstractMatrix{&lt;:AbstractFloat},
    namelists::Namelists,
    domain::Domain,
)</code></pre><p>Exchange all zonal halo values of a matrix by performing bidirectional MPI communication between left and right neighbor processes.</p><pre><code class="language-julia hljs">set_zonal_halos_of_field!(
    field::AbstractArray{&lt;:Real, 3},
    namelists::Namelists,
    domain::Domain;
    layers::NTuple{3, &lt;:Integer} = (-1, -1, -1),
)</code></pre><p>Exchange a specified number of zonal halo values of a 3D array with an algorithm similar to that implemented in the method for matrices.</p><pre><code class="language-julia hljs">set_zonal_halos_of_field!(
    field::AbstractArray{&lt;:AbstractFloat, 5},
    namelists::Namelists,
    domain::Domain;
    layers::NTuple{3, &lt;:Integer} = (-1, -1, -1),
)</code></pre><p>Exchange a specified number of zonal halo values of a 5D array with an algorithm similar to that implemented in the method for 3D arrays.</p><p>The first three dimensions of the array are assumed to represent the dimensions of physical space.</p><p><strong>Arguments</strong></p><ul><li><p><code>field</code>: Input array.</p></li><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li></ul><p><strong>Keywords</strong></p><ul><li><code>layers</code>: The number of halo layers in each dimension. Use <code>-1</code> for the default values from <code>namelists</code>.</li></ul></div></section></article><h2 id="VariableTypes"><a class="docs-heading-anchor" href="#VariableTypes">VariableTypes</a><a id="VariableTypes-1"></a><a class="docs-heading-anchor-permalink" href="#VariableTypes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.VariableTypes" href="#PinCFlow.Types.VariableTypes"><code>PinCFlow.Types.VariableTypes</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">VariableTypes</code></pre><p>Module for composite types needed for the integration in time.</p><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.NamelistTypes"><code>PinCFlow.Types.NamelistTypes</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes"><code>PinCFlow.Types.FoundationalTypes</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.VariableTypes.Auxiliaries" href="#PinCFlow.Types.VariableTypes.Auxiliaries"><code>PinCFlow.Types.VariableTypes.Auxiliaries</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Auxiliaries{A &lt;: AbstractArray{&lt;:AbstractFloat, 3}}</code></pre><p>Auxiliary array used in the reconstruction of prognostic variables.</p><pre><code class="language-julia hljs">Auxiliaries(domain::Domain)::Auxiliaries</code></pre><p>Construct an <code>Auxiliaries</code> instance with a zero-initialized auxiliary array sized according to the MPI subdomain dimensions.</p><p><strong>Fields</strong></p><ul><li><code>phi::A</code>: Auxiliary array used as input for <a href="../flux_calculator/#PinCFlow.FluxCalculator.apply_3d_muscl!"><code>PinCFlow.FluxCalculator.apply_3d_muscl!</code></a>.</li></ul><p><strong>Arguments</strong></p><ul><li><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.VariableTypes.Backups" href="#PinCFlow.Types.VariableTypes.Backups"><code>PinCFlow.Types.VariableTypes.Backups</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Backups{A &lt;: AbstractArray{&lt;:AbstractFloat, 3}}</code></pre><p>Container for backup copies needed in the semi-implicit time scheme.</p><pre><code class="language-julia hljs">Backups(domain::Domain)::Backups</code></pre><p>Initialize backup arrays sized according to the dimensions of the MPI subdomain.</p><p><strong>Fields</strong></p><ul><li><p><code>rhoold::A</code>: Density backup.</p></li><li><p><code>rhopold::A</code>: Density-fluctuations backup.</p></li><li><p><code>uold::A</code>: Zonal-wind backup.</p></li><li><p><code>vold::A</code>: Meridional-wind backup.</p></li><li><p><code>wold::A</code>: Transformed-vertical-wind backup.</p></li></ul><p><strong>Arguments</strong></p><ul><li><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.VariableTypes.Fluxes" href="#PinCFlow.Types.VariableTypes.Fluxes"><code>PinCFlow.Types.VariableTypes.Fluxes</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Fluxes{
    A &lt;: AbstractArray{&lt;:AbstractFloat, 4},
    B &lt;: AbstractArray{&lt;:AbstractFloat, 4},
}</code></pre><p>Arrays for fluxes needed in the computation of the left-hand sides.</p><p>The first three dimensions represent physical space and the fourth dimension represents the flux direction.</p><pre><code class="language-julia hljs">Fluxes(namelists::Namelists, domain::Domain)::Fluxes</code></pre><p>Construct a <code>Fluxes</code> instance with dimensions depending on whether or not the model is compressible, by dispatching to the appropriate method.</p><pre><code class="language-julia hljs">Fluxes(domain::Domain, model::Union{Boussinesq, PseudoIncompressible})::Fluxes</code></pre><p>Construct a <code>Fluxes</code> instance in non-compressible modes, with a zero-size array for mass-weighted potential-temperature fluxes.</p><pre><code class="language-julia hljs">Fluxes(domain::Domain, model::Compressible)::Fluxes</code></pre><p>Construct a <code>Fluxes</code> instance in compressible mode.</p><p><strong>Fields</strong></p><ul><li><p><code>phirho::A</code>: Density fluxes.</p></li><li><p><code>phirhop::A</code>: Density-fluctuations fluxes.</p></li><li><p><code>phiu::A</code>: Zonal-momentum fluxes.</p></li><li><p><code>phiv::A</code>: Meridional-momentum fluxes.</p></li><li><p><code>phiw::A</code>: Transformed-vertical-momentum fluxes.</p></li><li><p><code>phip::B</code>: Mass-weighted potential-temperature fluxes.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>model</code>: Dynamic equations.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.VariableTypes.Increments" href="#PinCFlow.Types.VariableTypes.Increments"><code>PinCFlow.Types.VariableTypes.Increments</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Increments{
    A &lt;: AbstractArray{&lt;:AbstractFloat, 3},
    B &lt;: AbstractArray{&lt;:AbstractFloat, 3},
    C &lt;: AbstractArray{&lt;:AbstractFloat, 3},
}</code></pre><p>Container for the Runge-Kutta updates of the prognostic variables, as well as the Exner-pressure update of the Poisson solver.</p><pre><code class="language-julia hljs">Increments(namelists::Namelists, domain::Domain)::Increments</code></pre><p>Create an <code>Increments</code> instance with dimensions depending on the model configuration, by dispatching to the appropriate method.</p><pre><code class="language-julia hljs">Increments(domain::Domain, model::Boussinesq)::Increments</code></pre><p>Create an <code>Increments</code> instance in Boussinesq mode, with zero-size arrays for the density and mass-weighted potential-temperature update.</p><pre><code class="language-julia hljs">Increments(domain::Domain, model::PseudoIncompressible)::Increments</code></pre><p>Create an <code>Increments</code> instance in pseudo-incompressible mode, with a zero-size array for the mass-weighted potential-temperature update.</p><pre><code class="language-julia hljs">Increments(domain::Domain, model::Compressible)::Increments</code></pre><p>Create an <code>Increments</code> instance in compressible mode.</p><p><strong>Fields</strong></p><ul><li><p><code>drho::A</code>: Density update.</p></li><li><p><code>drhop::B</code>: Density-fluctuations update.</p></li><li><p><code>du::B</code>: Zonal-momentum update.</p></li><li><p><code>dv::B</code>: Meridional-momentum update.</p></li><li><p><code>dw::B</code>: Transformed-vertical-momentum update.</p></li><li><p><code>dpip::B</code>: Exner-pressure update.</p></li><li><p><code>dp::C</code>: Mass-weighted potential-temperature update.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>model</code>: Dynamic equations.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.VariableTypes.Predictands" href="#PinCFlow.Types.VariableTypes.Predictands"><code>PinCFlow.Types.VariableTypes.Predictands</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Predictands{
    A &lt;: AbstractArray{&lt;:AbstractFloat, 3},
    B &lt;: AbstractArray{&lt;:AbstractFloat, 3},
}</code></pre><p>Arrays for prognostic variables.</p><pre><code class="language-julia hljs">Predictands(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    atmosphere::Atmosphere,
    grid::Grid,
)::Predictands</code></pre><p>Construct a <code>Predictands</code> instance.</p><p>The predictands are initialized with the corresponding functions in <code>namelists.atmosphere</code>. The mass-weighted potential temperature <code>p</code> is constructed depending on the dynamic equations (see <code>set_p</code>).</p><p><strong>Fields</strong></p><ul><li><p><code>rho::A</code>: Density.</p></li><li><p><code>rhop::A</code>: Density-fluctuations.</p></li><li><p><code>u::A</code>: Zonal wind.</p></li><li><p><code>v::A</code>: Meridional wind.</p></li><li><p><code>w::A</code>: Transformed vertical wind.</p></li><li><p><code>pip::A</code>: Exner-pressure fluctuations.</p></li><li><p><code>p::B</code>: Mass-weighted potential temperature.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>constants</code>: Physical constants and reference values.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>atmosphere</code>: Atmospheric-background fields.</p></li><li><p><code>grid</code>: Collection of parameters and fields that describe the grid.</p></li></ul><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.FoundationalTypes.set_zonal_boundaries_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_zonal_boundaries_of_field!</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes.set_meridional_boundaries_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_meridional_boundaries_of_field!</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes.set_vertical_boundaries_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_vertical_boundaries_of_field!</code></a></p></li><li><p><a href="#PinCFlow.Types.VariableTypes.set_p"><code>PinCFlow.Types.VariableTypes.set_p</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.VariableTypes.Reconstructions" href="#PinCFlow.Types.VariableTypes.Reconstructions"><code>PinCFlow.Types.VariableTypes.Reconstructions</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Reconstructions{A &lt;: AbstractArray{&lt;:AbstractFloat, 5}}</code></pre><p>Arrays for the reconstructions of prognostic variables.</p><p>The first three dimensions represent physical space, the fourth represents the physical-space dimension of the reconstruction and the fifth the two directions in which it is computed.</p><pre><code class="language-julia hljs">Reconstructions(domain::Domain)::Reconstructions</code></pre><p>Construct a <code>Reconstructions</code> instance with zero-initialized arrays.</p><p><strong>Fields</strong></p><ul><li><p><code>rhotilde::A</code>: Reconstructed density.</p></li><li><p><code>rhoptilde::A</code>: Reconstructed density fluctuations.</p></li><li><p><code>utilde::A</code>: Reconstructed zonal momentum.</p></li><li><p><code>vtilde::A</code>: Reconstructed meridional momentum.</p></li><li><p><code>wtilde::A</code>: Reconstructed vertical momentum.</p></li></ul><p><strong>Arguments</strong></p><ul><li><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.VariableTypes.Variables" href="#PinCFlow.Types.VariableTypes.Variables"><code>PinCFlow.Types.VariableTypes.Variables</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Variables{
    A &lt;: Predictands,
    B &lt;: Increments,
    C &lt;: Backups,
    D &lt;: Auxiliaries,
    E &lt;: Reconstructions,
    F &lt;: Fluxes,
}</code></pre><p>Container for arrays needed for the prediction of the prognostic variables.</p><pre><code class="language-julia hljs">Variables(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    atmosphere::Atmosphere,
)::Variables</code></pre><p>Construct a <code>Variables</code> instance, with array dimensions and initial values set according to the model configuration.</p><p><strong>Fields</strong></p><ul><li><p><code>predictands::A</code>: Prognostic variables.</p></li><li><p><code>increments::B</code>: Runge-Kutta increments and pressure correction.</p></li><li><p><code>backups::C</code>: Backups of the prognostic variables needed in the semi-implicit time scheme.</p></li><li><p><code>auxiliaries::D</code>: Auxiliary array needed in the reconstruction.</p></li><li><p><code>reconstructions::E</code>: Reconstructions of the prognostic variables.</p></li><li><p><code>fluxes::F</code>: Fluxes of the prognostic variables.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>constants</code>: Physical constants and reference values.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>atmosphere</code>: Atmospheric-background fields.</p></li></ul><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.VariableTypes.Predictands"><code>PinCFlow.Types.VariableTypes.Predictands</code></a></p></li><li><p><a href="#PinCFlow.Types.VariableTypes.Increments"><code>PinCFlow.Types.VariableTypes.Increments</code></a></p></li><li><p><a href="#PinCFlow.Types.VariableTypes.Backups"><code>PinCFlow.Types.VariableTypes.Backups</code></a></p></li><li><p><a href="#PinCFlow.Types.VariableTypes.Auxiliaries"><code>PinCFlow.Types.VariableTypes.Auxiliaries</code></a></p></li><li><p><a href="#PinCFlow.Types.VariableTypes.Reconstructions"><code>PinCFlow.Types.VariableTypes.Reconstructions</code></a></p></li><li><p><a href="#PinCFlow.Types.VariableTypes.Fluxes"><code>PinCFlow.Types.VariableTypes.Fluxes</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.VariableTypes.set_p" href="#PinCFlow.Types.VariableTypes.set_p"><code>PinCFlow.Types.VariableTypes.set_p</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">set_p(
    model::Union{Boussinesq, PseudoIncompressible},
    rhobar::AbstractArray{&lt;:AbstractFloat, 3},
    thetabar::AbstractArray{&lt;:AbstractFloat, 3},
    rhop::AbstractArray{&lt;:AbstractFloat, 3},
    thetap::AbstractArray{&lt;:AbstractFloat, 3},
)::AbstractArray{&lt;:AbstractFloat, 3}</code></pre><p>Return a zero-size array in non-compressible modes.</p><p>In these cases, the mass-weighted potential temperature is a background field: constant in Boussinesq mode, vertically varying in pseudo-incompressible mode.</p><pre><code class="language-julia hljs">set_p(
    model::Compressible,
    rhobar::AbstractArray{&lt;:AbstractFloat, 3},
    thetabar::AbstractArray{&lt;:AbstractFloat, 3},
    rhop::AbstractArray{&lt;:AbstractFloat, 3},
    thetap::AbstractArray{&lt;:AbstractFloat, 3},
)::AbstractArray{&lt;:AbstractFloat, 3}</code></pre><p>Return <span>$P = \rho \theta = \left(\overline{\rho} + \rho&#39;\right) \left(\overline{\theta} + \theta&#39;\right)$</span> in compressible mode.</p><p>In compressible mode, the mass-weighted potential temperature is a prognostic variable.</p><p><strong>Arguments:</strong></p><ul><li><p><code>mode</code>: Dynamic equations.</p></li><li><p><code>rhobar</code>: Density background.</p></li><li><p><code>thetabar</code>: Potential-temperature background.</p></li><li><p><code>rhop</code>: Density fluctuations.</p></li><li><p><code>thetap</code>: Potential-temperature fluctuations.</p></li></ul></div></section></article><h2 id="PoissonTypes"><a class="docs-heading-anchor" href="#PoissonTypes">PoissonTypes</a><a id="PoissonTypes-1"></a><a class="docs-heading-anchor-permalink" href="#PoissonTypes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.PoissonTypes" href="#PinCFlow.Types.PoissonTypes"><code>PinCFlow.Types.PoissonTypes</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PoissonTypes</code></pre><p>Module for composite types used by the Poisson solver.</p><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.NamelistTypes"><code>PinCFlow.Types.NamelistTypes</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes"><code>PinCFlow.Types.FoundationalTypes</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.PoissonTypes.BicGStab" href="#PinCFlow.Types.PoissonTypes.BicGStab"><code>PinCFlow.Types.PoissonTypes.BicGStab</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BicGStab{
    A &lt;: AbstractMatrix{&lt;:AbstractFloat},
    B &lt;: AbstractArray{&lt;:AbstractFloat, 3},
}</code></pre><p>Workspace arrays used by <a href="../poisson_solver/#PinCFlow.PoissonSolver.apply_bicgstab!"><code>PinCFlow.PoissonSolver.apply_bicgstab!</code></a>.</p><pre><code class="language-julia hljs">BicGStab(domain::Domain)::BicGStab</code></pre><p>Create a <code>BicGStab</code> instance with zero-initialized workspace arrays sized according to dimensions of the MPI subdomain.</p><p><strong>Fields</strong></p><ul><li><p><code>r_vm::A</code>: Vertically-averaged residual.</p></li><li><p><code>p::B</code>: Search direction.</p></li><li><p><code>r0::B</code>: Initial residual.</p></li><li><p><code>rold::B</code>: Previous residual.</p></li><li><p><code>r::B</code>: Current residual.</p></li><li><p><code>s::B</code>: Intermediate solution.</p></li><li><p><code>t::B</code>: Result of applying the linear operator to <code>s</code>.</p></li><li><p><code>v::B</code>: Result of applying the linear operator to <code>p</code>.</p></li><li><p><code>matvec::B</code>: Intermediate result of applying the linear operator.</p></li><li><p><code>v_pc::B</code>: Output of the preconditioner.</p></li></ul><p><strong>Arguments</strong></p><ul><li><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.PoissonTypes.Correction" href="#PinCFlow.Types.PoissonTypes.Correction"><code>PinCFlow.Types.PoissonTypes.Correction</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Correction{A &lt;: AbstractArray{&lt;:AbstractFloat, 3}}</code></pre><p>Correction terms used to update the horizontal wind in the corrector step.</p><pre><code class="language-julia hljs">Correction(domain::Domain)::Correction</code></pre><p>Create a <code>Correction</code> instance with zero-initialized arrays sized according to the dimensions of the MPI subdomain.</p><p><strong>Fields</strong></p><ul><li><p><code>corx::A</code>: Correction term for the zonal wind.</p></li><li><p><code>cory::A</code>: Correction term for the meridional wind.</p></li></ul><p><strong>Arguments</strong></p><ul><li><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.PoissonTypes.Operator" href="#PinCFlow.Types.PoissonTypes.Operator"><code>PinCFlow.Types.PoissonTypes.Operator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Operator{A &lt;: AbstractArray{&lt;:AbstractFloat, 3}}</code></pre><p>Workspace array for applying the linear operator of the Poisson solver.</p><pre><code class="language-julia hljs">Operator(domain::Domain)::Operator</code></pre><p>Create an <code>Operator</code> instance with a zero-initialized array sized according to the dimensions of the MPI subdomain.</p><p><strong>Fields</strong></p><ul><li><code>s::A</code>: Auxiliary array for enforcing boundary conditions and performing MPI communication prior to the application of the linear operator.</li></ul><p><strong>Arguments</strong></p><ul><li><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.PoissonTypes.Poisson" href="#PinCFlow.Types.PoissonTypes.Poisson"><code>PinCFlow.Types.PoissonTypes.Poisson</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Poisson{
    A &lt;: AbstractArray{&lt;:AbstractFloat, 3},
    B &lt;: Tensor,
    C &lt;: Operator,
    D &lt;: Preconditioner,
    E &lt;: BicGStab,
    F &lt;: Correction,
}</code></pre><p>Main container for Poisson-solver workspace and solution arrays.</p><pre><code class="language-julia hljs">Poisson(domain::Domain)::Poisson</code></pre><p>Create a <code>Poisson</code> instance with an initialized Poisson-solver workspace, sized according to the dimensions of the MPI subdomain.</p><p><strong>Fields</strong></p><ul><li><p><code>rhs::A</code>: Right-hand side.</p></li><li><p><code>solution::A</code>: Solution of the Poisson problem.</p></li><li><p><code>tensor::B</code>: Tensor elements of the linear operator.</p></li><li><p><code>operator::C</code>: Workspace arrays for applying the linear operator.</p></li><li><p><code>preconditioner::D</code>: Workspace arrays for applying the preconditioner.</p></li><li><p><code>bicgstab::E</code>: Workspace arrays used by the BicGStab algorithm.</p></li><li><p><code>correction::F</code>: Correction terms used to update the horizontal wind in the corrector step.</p></li></ul><p><strong>Arguments</strong></p><ul><li><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</li></ul><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.PoissonTypes.Tensor"><code>PinCFlow.Types.PoissonTypes.Tensor</code></a></p></li><li><p><a href="#PinCFlow.Types.PoissonTypes.Operator"><code>PinCFlow.Types.PoissonTypes.Operator</code></a></p></li><li><p><a href="#PinCFlow.Types.PoissonTypes.Preconditioner"><code>PinCFlow.Types.PoissonTypes.Preconditioner</code></a></p></li><li><p><a href="#PinCFlow.Types.PoissonTypes.BicGStab"><code>PinCFlow.Types.PoissonTypes.BicGStab</code></a></p></li><li><p><a href="#PinCFlow.Types.PoissonTypes.Correction"><code>PinCFlow.Types.PoissonTypes.Correction</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.PoissonTypes.Preconditioner" href="#PinCFlow.Types.PoissonTypes.Preconditioner"><code>PinCFlow.Types.PoissonTypes.Preconditioner</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Preconditioner{
    A &lt;: AbstractArray{&lt;:AbstractFloat, 3},
    B &lt;: AbstractMatrix{&lt;:AbstractFloat},
}</code></pre><p>Workspace arrays for applying the preconditioner.</p><pre><code class="language-julia hljs">Preconditioner(domain::Domain)::Preconditioner</code></pre><p>Create a <code>Preconditioner</code> instance with zero-initialized arrays sized according to the dimensions of the MPI subdomain.</p><p><strong>Fields</strong></p><ul><li><p><code>s_pc::A</code>: Solution computed by the preconditioner.</p></li><li><p><code>q_pc::A</code>: Auxiliary array used for the upward sweep.</p></li><li><p><code>p_pc::B</code>: Auxiliary array used for the upward sweep and downward pass.</p></li><li><p><code>s_pc_bc::B</code>: MPI communication buffer for <code>s_pc</code>.</p></li><li><p><code>q_pc_bc::B</code>: MPI communication buffer for <code>q_pc</code>.</p></li></ul><p><strong>Arguments</strong></p><ul><li><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.PoissonTypes.Tensor" href="#PinCFlow.Types.PoissonTypes.Tensor"><code>PinCFlow.Types.PoissonTypes.Tensor</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Tensor{A &lt;: AbstractArray{&lt;:AbstractFloat, 3}}</code></pre><p>Tensor elements of the linear operator, as computed by <a href="../poisson_solver/#PinCFlow.PoissonSolver.compute_operator!"><code>PinCFlow.PoissonSolver.compute_operator!</code></a>.</p><pre><code class="language-julia hljs">Tensor(domain::Domain)::Tensor</code></pre><p>Create a <code>Tensor</code> instance with zero-initialized arrays sized according to the dimensions of the MPI subdomain.</p><p><strong>Fields</strong></p><ul><li><p><code>ac_b::A</code>: Coefficient applied to <span>$s$</span>.</p></li><li><p><code>al_b::A</code>: Coefficient applied to <span>$s_{i - 1}$</span>.</p></li><li><p><code>ar_b::A</code>: Coefficient applied to <span>$s_{i + 1}$</span>.</p></li><li><p><code>ab_b::A</code>: Coefficient applied to <span>$s_{j - 1}$</span>.</p></li><li><p><code>af_b::A</code>: Coefficient applied to <span>$s_{j + 1}$</span>.</p></li><li><p><code>ad_b::A</code>: Coefficient applied to <span>$s_{k - 1}$</span>.</p></li><li><p><code>au_b::A</code>: Coefficient applied to <span>$s_{k + 1}$</span>.</p></li><li><p><code>ald_b::A</code>: Coefficient applied to <span>$s_{i - 1, k - 1}$</span>.</p></li><li><p><code>alu_b::A</code>: Coefficient applied to <span>$s_{i - 1, k + 1}$</span>.</p></li><li><p><code>ard_b::A</code>: Coefficient applied to <span>$s_{i + 1, k - 1}$</span>.</p></li><li><p><code>aru_b::A</code>: Coefficient applied to <span>$s_{i + 1, k + 1}$</span>.</p></li><li><p><code>abd_b::A</code>: Coefficient applied to <span>$s_{j - 1, k - 1}$</span>.</p></li><li><p><code>abu_b::A</code>: Coefficient applied to <span>$s_{j - 1, k + 1}$</span>.</p></li><li><p><code>afd_b::A</code>: Coefficient applied to <span>$s_{j + 1, k - 1}$</span>.</p></li><li><p><code>afu_b::A</code>: Coefficient applied to <span>$s_{j + 1, k + 1}$</span>.</p></li><li><p><code>add_b::A</code>: Coefficient applied to <span>$s_{k - 2}$</span>.</p></li><li><p><code>auu_b::A</code>: Coefficient applied to <span>$s_{k + 2}$</span>.</p></li><li><p><code>aldd_b::A</code>: Coefficient applied to <span>$s_{i - 1, k - 2}$</span>.</p></li><li><p><code>aluu_b::A</code>: Coefficient applied to <span>$s_{i - 1, k + 2}$</span>.</p></li><li><p><code>ardd_b::A</code>: Coefficient applied to <span>$s_{i + 1, k - 2}$</span>.</p></li><li><p><code>aruu_b::A</code>: Coefficient applied to <span>$s_{i + 1, k + 2}$</span>.</p></li><li><p><code>abdd_b::A</code>: Coefficient applied to <span>$s_{j - 1, k - 2}$</span>.</p></li><li><p><code>abuu_b::A</code>: Coefficient applied to <span>$s_{j - 1, k + 2}$</span>.</p></li><li><p><code>afdd_b::A</code>: Coefficient applied to <span>$s_{j + 1, k - 2}$</span>.</p></li><li><p><code>afuu_b::A</code>: Coefficient applied to <span>$s_{j + 1, k + 2}$</span>.</p></li></ul><p><strong>Arguments</strong></p><ul><li><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</li></ul></div></section></article><h2 id="WKBTypes"><a class="docs-heading-anchor" href="#WKBTypes">WKBTypes</a><a id="WKBTypes-1"></a><a class="docs-heading-anchor-permalink" href="#WKBTypes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.WKBTypes" href="#PinCFlow.Types.WKBTypes"><code>PinCFlow.Types.WKBTypes</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WKBTypes</code></pre><p>Module that contains a collection of types for WKB ray tracing calculations including ray data structures, surface indices, integrals, tendencies, and increments.</p><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.NamelistTypes"><code>PinCFlow.Types.NamelistTypes</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes"><code>PinCFlow.Types.FoundationalTypes</code></a></p></li><li><p><a href="#PinCFlow.Types.VariableTypes"><code>PinCFlow.Types.VariableTypes</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.WKBTypes.MergedRays" href="#PinCFlow.Types.WKBTypes.MergedRays"><code>PinCFlow.Types.WKBTypes.MergedRays</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MergedRays{
    A &lt;: AbstractMatrix{&lt;:AbstractFloat},
    B &lt;: AbstractVector{&lt;:AbstractFloat},
}</code></pre><p>Composite type used for creating merged ray volumes.</p><pre><code class="language-julia hljs">MergedRays(bounds::Integer, count::Integer)::MergedRays</code></pre><p>Construct a <code>MergedRays</code> instance, with arrays sized according to the given dimensions.</p><p><strong>Fields</strong></p><ul><li><p><code>xr::A</code>: Outermost ray-volume bounds in <span>$x$</span>.</p></li><li><p><code>yr::A</code>: Outermost ray-volume bounds in <span>$y$</span>.</p></li><li><p><code>zr::A</code>: Outermost ray-volume bounds in <span>$z$</span>.</p></li><li><p><code>kr::A</code>: Outermost ray-volume bounds in <span>$k$</span>.</p></li><li><p><code>lr::A</code>: Outermost ray-volume bounds in <span>$l$</span>.</p></li><li><p><code>mr::A</code>: Outermost ray-volume bounds in <span>$m$</span>.</p></li><li><p><code>nr::B</code>: Wave-action integral.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>bounds</code>: Number of bounds in each dimension.</p></li><li><p><code>count</code>: Maximum ray-volume count per grid cell.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.WKBTypes.Rays" href="#PinCFlow.Types.WKBTypes.Rays"><code>PinCFlow.Types.WKBTypes.Rays</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Rays{A &lt;: AbstractArray{&lt;:AbstractFloat, 4}}</code></pre><p>Container for prognostic ray-volume properties.</p><pre><code class="language-julia hljs">Rays(nray_wrk::Integer, nxx::Integer, nyy::Integer, nzz::Integer)::Rays</code></pre><p>Construct a <code>Rays</code> instance, with arrays sized according to the given dimensions.</p><p><strong>Fields</strong></p><ul><li><p><code>x::A</code>: Position in <span>$x$</span>.</p></li><li><p><code>y::A</code>: Position in <span>$y$</span>.</p></li><li><p><code>z::A</code>: Position in <span>$z$</span>.</p></li><li><p><code>k::A</code>: Position in <span>$k$</span>.</p></li><li><p><code>l::A</code>: Position in <span>$l$</span>.</p></li><li><p><code>m::A</code>: Position in <span>$m$</span>.</p></li><li><p><code>dxray::A</code>: Extent in <span>$x$</span>.</p></li><li><p><code>dyray::A</code>: Extent in <span>$y$</span>.</p></li><li><p><code>dzray::A</code>: Extent in <span>$z$</span>.</p></li><li><p><code>dkray::A</code>: Extent in <span>$k$</span>.</p></li><li><p><code>dlray::A</code>: Extent in <span>$l$</span>.</p></li><li><p><code>dmray::A</code>: Extent in <span>$m$</span>.</p></li><li><p><code>dens::A</code>: Phase-space wave-action density.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>nray_wrk</code>: Size of the spectral dimension of ray-volume arrays.</p></li><li><p><code>nxx</code>: Number of subdomain grid points in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>nyy</code>: Number of subdomain grid points in <span>$\widehat{y}$</span>-direction.</p></li><li><p><code>nzz</code>: Number of subdomain grid points in <span>$\widehat{z}$</span>-direction.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.WKBTypes.SurfaceIndices" href="#PinCFlow.Types.WKBTypes.SurfaceIndices"><code>PinCFlow.Types.WKBTypes.SurfaceIndices</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SurfaceIndices{A &lt;: AbstractArray{&lt;:Integer, 3}, B &lt;: AbstractVector{&lt;:Integer}}</code></pre><p>Indices that connect orographic wave modes to the corresponding ray volumes launched by <a href="../msgwam/#PinCFlow.MSGWaM.RaySources.activate_orographic_source!"><code>PinCFlow.MSGWaM.RaySources.activate_orographic_source!</code></a>.</p><pre><code class="language-julia hljs">SurfaceIndices(n_sfc::Integer, nxx::Integer, nyy::Integer)::SurfaceIndices</code></pre><p>Construct a <code>SurfaceIndices</code> instance, with arrays sized according to the given dimensions.</p><p><strong>Fields</strong></p><ul><li><p><code>rs::A</code>: Ray-volume indices.</p></li><li><p><code>ixs::B</code>: Zonal indices within grid cells.</p></li><li><p><code>jys::B</code>: Meridional indices within grid cells.</p></li><li><p><code>kzs::B</code>: Vertical indices within grid cells.</p></li><li><p><code>iks::B</code>: Indices in <span>$k$</span>.</p></li><li><p><code>jls::B</code>: Indices in <span>$l$</span>.</p></li><li><p><code>kms::B</code>: Indices in <span>$m$</span>.</p></li><li><p><code>alphas::B</code>: Wave-mode indices.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>n_sfc</code>: Number of orographic wave modes per grid cell.</p></li><li><p><code>nxx</code>: Number of subdomain grid points in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>nyy</code>: Number of subdomain grid points in <span>$\widehat{y}$</span>-direction.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.WKBTypes.WKB" href="#PinCFlow.Types.WKBTypes.WKB"><code>PinCFlow.Types.WKBTypes.WKB</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WKB{
    A &lt;: Integer,
    B &lt;: AbstractArray{&lt;:Integer, 3},
    C &lt;: Rays,
    D &lt;: MergedRays,
    E &lt;: SurfaceIndices,
    F &lt;: WKBIncrements,
    G &lt;: WKBIntegrals,
    H &lt;: WKBTendencies,
    I &lt;: Ref{&lt;:AbstractFloat},
    J &lt;: AbstractArray{&lt;:AbstractFloat, 3},
    K &lt;: AbstractMatrix{&lt;:AbstractFloat},
}</code></pre><p>Main container for WKB ray-tracing data and parameters.</p><pre><code class="language-julia hljs">WKB(namelists::Namelists, domain::Domain)::WKB</code></pre><p>Construct a <code>WKB</code> instance by dispatching to a test-case-specific method.</p><pre><code class="language-julia hljs">WKB(namelists::Namelists, domain::Domain, wkb_mode::NoWKB)::WKB</code></pre><p>Construct a <code>WKB</code> instance with zero-size arrays for non-WKB configurations.</p><pre><code class="language-julia hljs">WKB(
    namelists::Namelists,
    domain::Domain,
    wkb_mode::Union{SteadyState, SingleColumn, MultiColumn},
)::WKB</code></pre><p>Construct a <code>WKB</code> instance.</p><p>This method primarily determines the size of the spectral dimension of ray-volume arrays and initializes them and related arrays (with zeros) accordingly. The proper initialization with nonzero wave action is performed by <a href="../msgwam/#PinCFlow.MSGWaM.RayUpdate.initialize_rays!"><code>PinCFlow.MSGWaM.RayUpdate.initialize_rays!</code></a>.</p><p><strong>Fields</strong></p><ul><li><p><code>nxray::A</code>: Number of ray volumes allowed in <span>$\widehat{x}$</span>, per grid cell and wave mode (<code>multiplication_factor * nrx * nrk</code>, taken from <code>namelists.wkb</code>).</p></li><li><p><code>nyray::A</code>: Number of ray volumes allowed in <span>$\widehat{y}$</span>, per grid cell and wave mode (<code>multiplication_factor * nry * nrl</code>, taken from <code>namelists.wkb</code>).</p></li><li><p><code>nzray::A</code>: Number of ray volumes allowed in <span>$\widehat{z}$</span>, per grid cell and wave mode (<code>multiplication_factor * nrz * nrm</code>, taken from <code>namelists.wkb</code>).</p></li><li><p><code>nxray_wrk::A</code>: <code>2 * nxray</code>.</p></li><li><p><code>nyray_wrk::A</code>: <code>2 * nyray</code>.</p></li><li><p><code>nzray_wrk::A</code>: <code>2 * nzray</code>.</p></li><li><p><code>nray_max::A</code>: Maximum ray-volume count allowed per grid-cell before merging is triggered (<code>nxray * nyray * nzray * namelists.wkb.wave_modes</code>).</p></li><li><p><code>nray_wrk::A</code>: Size of the spectral dimension of ray-volume arrays (<code>nxray_wrk * nyray_wrk * nzray_wrk</code>).</p></li><li><p><code>n_sfc::A</code>: Number of orographic wave modes.</p></li><li><p><code>nray::B</code>: Ray-volume count in each grid cell.</p></li><li><p><code>rays::C</code>: Prognostic ray-volume properties.</p></li><li><p><code>merged_rays::D</code>: Container used for creating merged ray volumes.</p></li><li><p><code>surface_indices::E</code>: Indices that connect orographic wave modes to ray volumes.</p></li><li><p><code>increments::F</code>: WKBIncrements of the prognostic ray-volume properties.</p></li><li><p><code>integrals::G</code>: Integrals of ray-volume properties.</p></li><li><p><code>tendencies::H</code>: Gravity-wave drag and heating fields.</p></li><li><p><code>cgx_max::I</code>: Maximum zonal group velocities.</p></li><li><p><code>cgy_max::I</code>: Maximum meridional group velocities.</p></li><li><p><code>cgz_max::J</code>: Maximum vertical group velocities.</p></li><li><p><code>zb::K</code>: Upper edge of the blocked layer.</p></li><li><p><code>diffusion::J</code>: Diffusion induced by wave breaking.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>constants</code>: Physical constants and reference values.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>grid</code>: Collection of parameters and fields that describe the grid.</p></li><li><p><code>wkb_mode</code>: Approximations used by MSGWaM.</p></li></ul><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.WKBTypes.Rays"><code>PinCFlow.Types.WKBTypes.Rays</code></a></p></li><li><p><a href="#PinCFlow.Types.WKBTypes.SurfaceIndices"><code>PinCFlow.Types.WKBTypes.SurfaceIndices</code></a></p></li><li><p><a href="#PinCFlow.Types.WKBTypes.WKBIncrements"><code>PinCFlow.Types.WKBTypes.WKBIncrements</code></a></p></li><li><p><a href="#PinCFlow.Types.WKBTypes.WKBIntegrals"><code>PinCFlow.Types.WKBTypes.WKBIntegrals</code></a></p></li><li><p><a href="#PinCFlow.Types.WKBTypes.WKBTendencies"><code>PinCFlow.Types.WKBTypes.WKBTendencies</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.WKBTypes.WKBIncrements" href="#PinCFlow.Types.WKBTypes.WKBIncrements"><code>PinCFlow.Types.WKBTypes.WKBIncrements</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WKBIncrements{A &lt;: AbstractArray{&lt;:AbstractFloat, 4}}</code></pre><p>Ray-volume-propagation increments.</p><pre><code class="language-julia hljs">WKBIncrements(
    nray_wrk::Integer,
    nxx::Integer,
    nyy::Integer,
    nzz::Integer,
)::WKBIncrements</code></pre><p>Construct an <code>WKBIncrements</code> instance, with arrays sized according to the given dimensions.</p><p><strong>Fields</strong></p><ul><li><p><code>dxray::A</code>: WKBIncrements for the position in <span>$x$</span>.</p></li><li><p><code>dyray::A</code>: WKBIncrements for the position in <span>$y$</span>.</p></li><li><p><code>dzray::A</code>: WKBIncrements for the position in <span>$z$</span>.</p></li><li><p><code>dkray::A</code>: WKBIncrements for the position in <span>$k$</span>.</p></li><li><p><code>dlray::A</code>: WKBIncrements for the position in <span>$l$</span>.</p></li><li><p><code>dmray::A</code>: WKBIncrements for the position in <span>$m$</span>.</p></li><li><p><code>ddxray::A</code>: WKBIncrements for the extent in <span>$x$</span>.</p></li><li><p><code>ddyray::A</code>: WKBIncrements for the extent in <span>$y$</span>.</p></li><li><p><code>ddzray::A</code>: WKBIncrements for the extent in <span>$z$</span>.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>nray_wrk</code>: Size of the spectral dimension of ray-volume arrays.</p></li><li><p><code>nxx</code>: Number of subdomain grid points in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>nyy</code>: Number of subdomain grid points in <span>$\widehat{y}$</span>-direction.</p></li><li><p><code>nzz</code>: Number of subdomain grid points in <span>$\widehat{z}$</span>-direction.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.WKBTypes.WKBIntegrals" href="#PinCFlow.Types.WKBTypes.WKBIntegrals"><code>PinCFlow.Types.WKBTypes.WKBIntegrals</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WKBIntegrals{A &lt;: AbstractArray{&lt;:AbstractFloat, 3}}</code></pre><p>Integrals of ray-volume properties.</p><pre><code class="language-julia hljs">WKBIntegrals(nxx::Integer, nyy::Integer, nzz::Integer)::WKBIntegrals</code></pre><p>Construct a <code>WKBIntegrals</code> instance, with arrays sized according to the given dimensions.</p><p><strong>Fields</strong></p><ul><li><p><code>uu::A</code>: Zonal zonal-momentum flux.</p></li><li><p><code>uv::A</code>: Meridional zonal-momentum flux.</p></li><li><p><code>uw::A</code>: Vertical zonal-momentum flux.</p></li><li><p><code>vv::A</code>: Meridional meridional-momentum flux.</p></li><li><p><code>vw::A</code>: Vertical meridional-momentum flux.</p></li><li><p><code>utheta::A</code>: Zonal mass-weighted potential-temperature flux.</p></li><li><p><code>vtheta::A</code>: Meridional mass-weighted potential-temperature flux.</p></li><li><p><code>e::A</code>: Wave-energy density.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>nxx</code>: Number of subdomain grid points in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>nyy</code>: Number of subdomain grid points in <span>$\widehat{y}$</span>-direction.</p></li><li><p><code>nzz</code>: Number of subdomain grid points in <span>$\widehat{z}$</span>-direction.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.WKBTypes.WKBTendencies" href="#PinCFlow.Types.WKBTypes.WKBTendencies"><code>PinCFlow.Types.WKBTypes.WKBTendencies</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WKBTendencies{A &lt;: AbstractArray{&lt;:AbstractFloat, 3}}</code></pre><p>Gravity-wave drag and heating fields.</p><pre><code class="language-julia hljs">WKBTendencies(nxx::Integer, nyy::Integer, nzz::Integer)::WKBTendencies</code></pre><p>Construct a <code>WKBTendencies</code> instance, with arrays sized according to the given dimensions.</p><p><strong>Fields</strong></p><ul><li><p><code>dudt::A</code>: Gravity-wave drag on the zonal momentum.</p></li><li><p><code>dvdt::A</code>: Gravity-wave drag on the meridional momentum.</p></li><li><p><code>dthetadt::A</code>: Gravity-wave heating term in the mass-weighted potential-temperature equation.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>nxx</code>: Number of subdomain grid points in <span>$\widehat{x}$</span>-direction.</p></li><li><p><code>nyy</code>: Number of subdomain grid points in <span>$\widehat{y}$</span>-direction.</p></li><li><p><code>nzz</code>: Number of subdomain grid points in <span>$\widehat{z}$</span>-direction.</p></li></ul></div></section></article><h2 id="TracerTypes"><a class="docs-heading-anchor" href="#TracerTypes">TracerTypes</a><a id="TracerTypes-1"></a><a class="docs-heading-anchor-permalink" href="#TracerTypes" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.TracerTypes" href="#PinCFlow.Types.TracerTypes"><code>PinCFlow.Types.TracerTypes</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TracerTypes</code></pre><p>Module for composite types needed for tracer transport.</p><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.NamelistTypes"><code>PinCFlow.Types.NamelistTypes</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes"><code>PinCFlow.Types.FoundationalTypes</code></a></p></li><li><p><a href="#PinCFlow.Types.VariableTypes"><code>PinCFlow.Types.VariableTypes</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.TracerTypes.Tracer" href="#PinCFlow.Types.TracerTypes.Tracer"><code>PinCFlow.Types.TracerTypes.Tracer</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Tracer{
    A &lt;: TracerPredictands,
    B &lt;: TracerIncrements,
    C &lt;: TracerAuxiliaries,
    D &lt;: TracerReconstructions,
    E &lt;: TracerFluxes,
    F &lt;: TracerForcings,
}</code></pre><p>Container for arrays needed for tracer transport.</p><pre><code class="language-julia hljs">Tracer(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    atmosphere::Atmosphere,
    grid::Grid,
    variables::Variables,
)::Tracer</code></pre><p>Construct a <code>Tracer</code> instance, with array dimensions and initial values set according to the model configuration.</p><p><strong>Fields</strong></p><ul><li><p><code>tracerpredictands::A</code>: Tracers.</p></li><li><p><code>tracerincrements::B</code>: Runge-Kutta updates of the tracers.</p></li><li><p><code>tracerauxiliaries::C</code>: Initial states of the tracers.</p></li><li><p><code>tracerreconstructions::D</code>: Reconstructions of the tracers.</p></li><li><p><code>tracerfluxes::E</code>: Fluxes of the tracers.</p></li><li><p><code>tracerforcings::F</code>: Forcing terms due to gravity-waves and turbulence.</p></li></ul><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>constants</code>: Physical constants and reference values.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>atmosphere</code>: Atmospheric-background fields.</p></li><li><p><code>grid</code>: Collection of parameters and fields describing the grid.</p></li><li><p><code>variables</code>: Container for arrays needed for the prediction of the prognostic variables.</p></li></ul><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.TracerTypes.TracerPredictands"><code>PinCFlow.Types.TracerTypes.TracerPredictands</code></a></p></li><li><p><a href="#PinCFlow.Types.TracerTypes.TracerIncrements"><code>PinCFlow.Types.TracerTypes.TracerIncrements</code></a></p></li><li><p><a href="#PinCFlow.Types.TracerTypes.TracerAuxiliaries"><code>PinCFlow.Types.TracerTypes.TracerAuxiliaries</code></a></p></li><li><p><a href="#PinCFlow.Types.TracerTypes.TracerReconstructions"><code>PinCFlow.Types.TracerTypes.TracerReconstructions</code></a></p></li><li><p><a href="#PinCFlow.Types.TracerTypes.TracerFluxes"><code>PinCFlow.Types.TracerTypes.TracerFluxes</code></a></p></li><li><p><a href="#PinCFlow.Types.TracerTypes.TracerForcings"><code>PinCFlow.Types.TracerTypes.TracerForcings</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.TracerTypes.TracerAuxiliaries" href="#PinCFlow.Types.TracerTypes.TracerAuxiliaries"><code>PinCFlow.Types.TracerTypes.TracerAuxiliaries</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TracerAuxiliaries{A &lt;: AbstractArray{&lt;:AbstractFloat, 3}}</code></pre><p>Initial states of the tracers.</p><pre><code class="language-julia hljs">TracerAuxiliaries(tracerpredictands::TracerPredictands)::TracerAuxiliaries</code></pre><p>Construct a <code>TracerAuxiliaries</code> instance by copying the arrays in <code>tracerpredictands</code>.</p><p><strong>Fields</strong></p><ul><li><code>initialtracer::A</code>: Initial state of a non-dimensional tracer.</li></ul><p><strong>Arguments</strong></p><ul><li><code>tracerpredictands</code>: Tracers.</li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.TracerTypes.TracerFluxes" href="#PinCFlow.Types.TracerTypes.TracerFluxes"><code>PinCFlow.Types.TracerTypes.TracerFluxes</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TracerFluxes{A &lt;: AbstractArray{&lt;:AbstractFloat, 4}}</code></pre><p>Arrays for fluxes of tracers.</p><p>The first three dimensions represent physical space and the fourth dimension represents the flux direction.</p><pre><code class="language-julia hljs">TracerFluxes(namelists::Namelists, domain::Domain)::TracerFluxes</code></pre><p>Construct a <code>TracerFluxes</code> instance with dimensions depending on the general tracer-transport configuration, by dispatching to the appropriate method.</p><pre><code class="language-julia hljs">TracerFluxes(domain::Domain, tracer_setup::NoTracer)::TracerFluxes</code></pre><p>Construct a <code>TracerFluxes</code> instance with zero-size arrays for configurations without tracer transport.</p><pre><code class="language-julia hljs">TracerFluxes(domain::Domain, tracer_setup::TracerOn)::TracerFluxes</code></pre><p>Construct a <code>TracerFluxes</code> instance with zero-initialized arrays.</p><p><strong>Fields</strong></p><ul><li><code>phichi::A</code>: Fluxes of a non-dimensional tracer.</li></ul><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>tracer_setup</code>: General tracer-transport configuration.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.TracerTypes.TracerForcings" href="#PinCFlow.Types.TracerTypes.TracerForcings"><code>PinCFlow.Types.TracerTypes.TracerForcings</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TracerForcings{A &lt;: TracerWKBImpact}</code></pre><p>Container for <code>TracerWKBImpact</code> instance with all necessary terms for the right-hand side of the tracer equation.</p><pre><code class="language-julia hljs">TracerForcings(namelists::Namelists, domain::Domain)::TracerForcings</code></pre><p>Construct a <code>TracerForcings</code> instance set according to the model configuration.</p><pre><code class="language-julia hljs">TracerForcings(
    namelists::Namelists,
    domain::Domain,
    tracer_setup::NoTracer,
)::TracerForcings</code></pre><p>Construct a <code>TracerForcings</code> instance for configurations without tracer transport.</p><pre><code class="language-julia hljs">TracerForcings(
    namelists::Namelists,
    domain::Domain,
    tracer_setup::TracerOn,
)::TracerForcings</code></pre><p>Construct a <code>TracerForcings</code> instance for configurations with tracer transport.</p><pre><code class="language-julia hljs">TracerForcings(domain::Domain, wkb_mode::NoWKB)::TracerForcings</code></pre><p>Construct a <code>TracerForcings</code> instance for configurations without WKB model.</p><pre><code class="language-julia hljs">TracerForcings(
    domain::Domain,
    wkb_mode::Union{SteadyState, SingleColumn, MultiColumn},
)::TracerForcings</code></pre><p>Construct a <code>TracerForcings</code> instance for configurations with tracer transport and WKB model.</p><p><strong>Fields</strong></p><ul><li><code>chiq0::A</code>: Leading-order tracer forcings.</li></ul><p><strong>Arguments:</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>tracer_setup</code>: General tracer-transport configuration.</p></li><li><p><code>wkb_mode</code>: Approximations used by MSGWaM.</p></li></ul><p><strong>See also:</strong></p><ul><li><a href="#PinCFlow.Types.TracerTypes.TracerWKBImpact"><code>PinCFlow.Types.TracerTypes.TracerWKBImpact</code></a></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.TracerTypes.TracerIncrements" href="#PinCFlow.Types.TracerTypes.TracerIncrements"><code>PinCFlow.Types.TracerTypes.TracerIncrements</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TracerIncrements{A &lt;: AbstractArray{&lt;:AbstractFloat, 3}}</code></pre><p>Arrays for the Runge-Kutta updates of tracers.</p><pre><code class="language-julia hljs">TracerIncrements(namelists::Namelists, domain::Domain)::TracerIncrements</code></pre><p>Construct a <code>TracerIncrements</code> instance with dimensions depending on the general tracer-transport configuration, by dispatching to the appropriate method.</p><pre><code class="language-julia hljs">TracerIncrements(domain::Domain, tracer_setup::NoTracer)::TracerIncrements</code></pre><p>Construct a <code>TracerIncrements</code> instance with zero-size arrays for configurations without tracer transport.</p><pre><code class="language-julia hljs">TracerIncrements(domain::Domain, tracer_setup::TracerOn)::TracerIncrements</code></pre><p>Construct a <code>TracerIncrements</code> instance with zero-initialized arrays.</p><p><strong>Fields</strong></p><ul><li><code>dchi::A</code>: Runge-Kutta update of a non-dimensional tracer.</li></ul><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>tracer_setup</code>: General tracer-transport configuration.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.TracerTypes.TracerPredictands" href="#PinCFlow.Types.TracerTypes.TracerPredictands"><code>PinCFlow.Types.TracerTypes.TracerPredictands</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TracerPredictands{A &lt;: AbstractArray{&lt;:AbstractFloat, 3}}</code></pre><p>Arrays for tracers.</p><pre><code class="language-julia hljs">TracerPredictands(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    atmosphere::Atmosphere,
    grid::Grid,
    variables::Variables,
)::TracerPredictands</code></pre><p>Construct a <code>TracerPredictands</code> instance with dimensions and initial values depending on the general configuration of tracer transport, by dispatching to the appropriate method.</p><pre><code class="language-julia hljs">TracerPredictands(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    atmosphere::Atmosphere,
    grid::Grid,
    tracer_setup::NoTracer,
    variables::Variables,
)::TracerPredictands</code></pre><p>Construct a <code>TracerPredictands</code> instance with zero-size arrays for configurations without tracer transport.</p><pre><code class="language-julia hljs">TracerPredictands(
    namelists::Namelists,
    constants::Constants,
    domain::Domain,
    atmosphere::Atmosphere,
    grid::Grid,
    tracer_setup::TracerOn,
    variables::Variables,
)::TracerPredictands</code></pre><p>Construct a <code>TracerPredictands</code> instance with a tracer initialized by the function <code>initial_tracer</code> in <code>namelists.tracer</code>. The tracer field is multiplied by the density.</p><p><strong>Fields</strong></p><ul><li><code>chi::A</code>: Non-dimensional tracer.</li></ul><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>constants</code>: Physical constants and reference values.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>atmosphere</code>: Atmospheric-background fields.</p></li><li><p><code>grid</code>: Collection of parameters and fields describing the grid.</p></li><li><p><code>tracer_setup</code>: General tracer-transport configuration.</p></li><li><p><code>variables</code>: Container for arrays needed for the prediction of the prognostic variables.</p></li></ul><p><strong>See also</strong></p><ul><li><p><a href="#PinCFlow.Types.FoundationalTypes.set_zonal_boundaries_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_zonal_boundaries_of_field!</code></a></p></li><li><p><a href="#PinCFlow.Types.FoundationalTypes.set_meridional_boundaries_of_field!"><code>PinCFlow.Types.FoundationalTypes.set_meridional_boundaries_of_field!</code></a></p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.TracerTypes.TracerReconstructions" href="#PinCFlow.Types.TracerTypes.TracerReconstructions"><code>PinCFlow.Types.TracerTypes.TracerReconstructions</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TracerReconstructions{A &lt;: AbstractArray{&lt;:AbstractFloat, 5}}</code></pre><p>Arrays for the reconstruction of tracers.</p><p>The first three dimensions represent physical space, the fourth represents the physical-space dimension of the reconstruction and the fifth the two directions in which it is computed.</p><pre><code class="language-julia hljs">TracerReconstructions(
    namelists::Namelists,
    domain::Domain,
)::TracerReconstructions</code></pre><p>Construct a <code>TracerReconstructions</code> instance with dimensions depending on the general tracer-transport configuration, by dispatching to the appropriate method.</p><pre><code class="language-julia hljs">TracerReconstructions(
    domain::Domain,
    tracer_setup::NoTracer,
)::TracerReconstructions</code></pre><p>Construct a <code>TracerReconstructions</code> instance with zero-size arrays for configurations without tracer transport.</p><pre><code class="language-julia hljs">TracerReconstructions(
    domain::Domain,
    tracer_setup::TracerOn,
)::TracerReconstructions</code></pre><p>Construct a <code>TracerReconstructions</code> instance with zero-initialized arrays.</p><p><strong>Fields</strong></p><ul><li><code>chitilde::A</code>: Reconstructions of a non-dimensional tracer.</li></ul><p><strong>Arguments</strong></p><ul><li><p><code>namelists</code>: Namelists with all model parameters.</p></li><li><p><code>domain</code>: Collection of domain-decomposition and MPI-communication parameters.</p></li><li><p><code>tracer_setup</code>: General tracer-transport configuration.</p></li></ul></div></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="PinCFlow.Types.TracerTypes.TracerWKBImpact" href="#PinCFlow.Types.TracerTypes.TracerWKBImpact"><code>PinCFlow.Types.TracerTypes.TracerWKBImpact</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TracerWKBImpact{A &lt;: AbstractArray{&lt;:AbstractFloat, 3}}</code></pre><p>Container for the gravity-wave-induced tracer fluxes and resulting tracer tendency.</p><pre><code class="language-julia hljs">TracerWKBImpact(nxi::Integer, nyi::Integer, nzi::Integer)::TracerWKBImpact</code></pre><p>Construct a <code>TracerWKBImpact</code> instance with array dimensions given by <code>nxi</code>, <code>nyi</code>, and <code>nzi</code>.</p><p><strong>Fields</strong></p><ul><li><p><code>uchi::A</code>: Zonal tracer fluxes due to unresolved gravity waves.</p></li><li><p><code>vchi::A</code>: Meridional tracer fluxes due to unresolved gravity waves.</p></li><li><p><code>wchi::A</code>: Vertical tracer fluxes due to unresolved gravity waves.</p></li><li><p><code>dchidt::A</code>: Leading-order tracer impact of unresolved gravity waves.</p></li></ul><p><strong>Arguments:</strong></p><ul><li><p><code>nxi</code>: Grid-points in <code>\widehat{x}</code>-direction.</p></li><li><p><code>nyi</code>: Grid-points in <code>\widehat{y}</code>-direction.</p></li><li><p><code>nzi</code>: Grid-points in <code>\widehat{z}</code>-direction.</p></li></ul></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../pincflow/">« PinCFlow</a><a class="docs-footer-nextpage" href="../mpi_operations/">MPIOperations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Thursday 23 October 2025 15:49">Thursday 23 October 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
