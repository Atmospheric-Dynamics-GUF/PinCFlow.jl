l2 = (
    dkr = 0.007872669f0,
    dlr = 0.007869804f0,
    dmr = 0.0055633695f0,
    dxr = 32563.35f0,
    dyr = 33026.46f0,
    dzr = 59228.37f0,
    kr = 0.05464656f0,
    lr = 0.054120462f0,
    mr = 0.059915353f0,
    n2 = 0.010127294f0,
    nr = 9.842951f12,
    p = 6048.868f0,
    pip = 8.132356f-6,
    rhobar = 11.957193f0,
    rhop = 9.480736f-6,
    t = 3600.0f0,
    thetabar = 20772.662f0,
    us = 3.2209344f0,
    vs = 2.971638f0,
    wts = 0.016842496f0,
    x = 18165.902f0,
    xr = 78170.92f0,
    y = 18165.902f0,
    yr = 75237.016f0,
    z = 729383.3f0,
    zr = 538628.9f0,
    ztilde = 784856.7f0,
)
linf = (
    dkr = 0.00039008714f0,
    dlr = 0.0003912721f0,
    dmr = 0.0002513274f0,
    dxr = 2000.0f0,
    dyr = 2000.0f0,
    dzr = 4000.0f0,
    kr = 0.0032972873f0,
    lr = 0.003304345f0,
    mr = 0.003172225f0,
    n2 = 0.00032025317f0,
    nr = 1.6523586f12,
    p = 296.09363f0,
    pip = 1.7817697f-6,
    rhobar = 0.9247667f0,
    rhop = 1.6641015f-6,
    t = 3600.0f0,
    thetabar = 1033.6132f0,
    us = 0.6409289f0,
    vs = 0.5871153f0,
    wts = 0.003865494f0,
    x = 9000.0f0,
    xr = 7491.164f0,
    y = 9000.0f0,
    yr = 7448.5522f0,
    z = 38000.0f0,
    zr = 29220.236f0,
    ztilde = 40000.0f0,
)
reference = (l2, linf)

@testset "WKB Wave packet" begin
    cp(
        joinpath(scripts_directory, "wave_packet_tools.jl"),
        "wave_packet_tools.jl",
    )
    test_example(
        joinpath(scripts_directory, "wkb_wave_packet.jl"),
        reference,
        :x_size => 10,
        :y_size => 10,
        :z_size => 10,
        :output => OutputNamelist(; prepare_restart = true);
        update_references,
    )
    rm("wave_packet_tools.jl")
end
