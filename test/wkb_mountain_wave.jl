l2 = (
    dkr = 0.0014210306f0,
    dlr = 0.0014214969f0,
    dmr = 0.00377529f0,
    dxr = 582395.44f0,
    dyr = 582382.3f0,
    dzr = 15302.134f0,
    kr = 0.014211272f0,
    lr = 3.14207f-6,
    mr = 0.037674423f0,
    n2 = 0.010105867f0,
    nr = 3.0217142f14,
    p = 5974.1997f0,
    pip = 0.0005039637f0,
    rhobar = 17.037529f0,
    rhop = 0.00074077264f0,
    t = 3600.0f0,
    thetabar = 13598.31f0,
    us = 447.22305f0,
    vs = 0.2377859f0,
    wts = 0.031385113f0,
    x = 363318.03f0,
    xr = 472561.2f0,
    y = 363318.03f0,
    yr = 494807.97f0,
    z = 364706.28f0,
    zr = 146424.84f0,
    ztilde = 392441.75f0,
)
linf = (
    dkr = 6.291286f-5,
    dlr = 6.286575f-5,
    dmr = 0.00016848728f0,
    dxr = 40000.0f0,
    dyr = 40000.0f0,
    dzr = 1996.0245f0,
    kr = 0.0006291297f0,
    lr = 3.9528152f-7,
    mr = 0.0016835398f0,
    n2 = 0.0003195756f0,
    nr = 1.5719312f13,
    p = 321.19855f0,
    pip = 5.496836f-5,
    rhobar = 1.0363692f0,
    rhop = 0.00028173593f0,
    t = 3600.0f0,
    thetabar = 556.8878f0,
    us = 10.15118f0,
    vs = 0.066648595f0,
    wts = 0.008934895f0,
    x = 180000.0f0,
    xr = 29970.162f0,
    y = 180000.0f0,
    yr = 30020.986f0,
    z = 19001.988f0,
    zr = 11889.466f0,
    ztilde = 20000.0f0,
)
reference = (l2, linf)

@testset "WKB mountain wave" begin
    test_example(
        joinpath(scripts_directory, "wkb_mountain_wave.jl"),
        reference,
        :x_size => 10,
        :y_size => 10,
        :z_size => 10,
        :output => OutputNamelist(; prepare_restart = true);
        update_references,
    )
end
