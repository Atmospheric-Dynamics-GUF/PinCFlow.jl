---
title: 'PinCFlow.jl: An idealized-atmospheric-flow solver coupled to the 3D transient gravity-wave model MSGWaM'
tags:
  - Julia
  - Gravity waves
  - Mountain waves
  - Parameterization
  - High-resolution simulations
authors:
  - name: Felix Jochum
    corresponding: true
    orcid: 0009-0006-9267-5006
    affiliation: 1
  - name: Irmgard Knop
    affiliation: 1
  - name: Jonas Rothermel
    affiliation: 1
  - name: Marco Artiano
    orcid: 0009-0009-5872-702X
    affiliation: 2
  - name: Arpit Babbar
    orcid: 0000-0002-9453-370X
    affiliation: 2
  - name: Hendrik Ranocha
    orcid: 0000-0002-3456-2277
    affiliation: 2
  - name: Stamen Dolapchiev
    affiliation: 1
  - name: Sandra Klewinghaus
    affiliation: 1
  - name: Ulrich Achatz
    affiliation: 1
affiliations:
  - name: Theory of Atmospheric Dynamics and Climate, Goethe University Frankfurt, Germany
    index: 1
  - name: Numerical Mathematics, Johannes Gutenberg University Mainz, Germany
    index: 2
date: ...
bibliography: paper.bib
---

# Summary

PinCFlow.jl is an atmospheric-flow solver that was designed for conducting idealized simulations. It integrates the Boussinesq, pseudo-incompressible and compressible equations in a conservative flux form [@Klein2009; @Rieper2013], using a a semi-implicit method that combines explicit and implicit time-stepping schemes [@Benacchio2019; @Schmid2021]. Spatially, the equations are discretized with a finite-volume method, such that all quantities are represented by spatial averages over grid cells and fluxes are computed on the respective cell interfaces. The grid is staggered so that the velocity components are defined at the same points as the corresponding fluxes of scalar quantities. PinCFlow.jl operates in a vertically stretched terrain-following coordinate system based on @GalChen1975a, @GalChen1975b and @Clark1977.

The Lagrangian WKB model MSGWaM is interactively coupled to the dynamical core of PinCFlow.jl, so that unresolved gravity waves may be parameterized in a manner that accounts for transience and horizontal propagation. The resolved fields are updated with tendencies computed by MSGWaM at the beginning of every time step. A description of the theory behind MSGWaM can be found in @Achatz2017 and @Achatz2023. For a numerical perspective and more information on the development, see @Muraschko2015, @Boeloeni2016, @Wilhelm2018, @Wei2019 and @Jochum2025.

# Statement of need

Gravity waves are generated by various sources, including convection, flow over orography and jet imbalances. As they propagate upward, they transport and deposit momentum and energy, thus impacting the large-scale flow. A significant part of the gravity-wave spectrum cannot be resolved by weather and climate models and must therefore be parameterized [@Fritts2003; @Alexander2010; @Achatz2024].

Most gravity-wave parameterizations rely on single-column and steady-state approximations, since these yield a comparatively simple and efficient way of calculating the mean-flow impact. However, it has become increasingly apparent that transience and horizontal propagation need to be accounted for in an accurate description of gravity-wave-mean-flow interaction [@Sato2009; @Senf2011; @Ehard2017; @Muraschko2015; @Boeloeni2016; @Wei2019].

The Multi-Scale Gravity-Wave Model (MSGWaM) has been created for this reason. Essential to its development, as to the improvement of the fundamental understanding of atmospheric dynamics, is the study of gravity waves in idealized high-resolution simulations. PinCFlow.jl provides a modeling infrastructure tailored to this exact need. Moreover, it is interactively coupled to MSGWaM, thus providing the first open-source access to it.

# Model description

In addition to its main mode, in which it integrates the pseudo-incompressible equations, PinCFlow.jl also provides a Boussinesq mode and a compressible mode. This allows for simulations in both simpler and more complex frameworks. The latter is especially useful for rotational flows with mountain waves, since the pseudo-incompressible theory is incompatible with heating above uneven terrain, but gravity waves do have an impact on the potential temperature in the presence of rotation.

MSGWaM can be run in 1D steady-state mode (which represents classic gravity-wave parameterizations), 1D transient mode (so that the impact of transience may be investigated separately, i.e. without horizontal propagation) and 3D transient mode (the full implementation of the theory).

![Overview of PinCFlow.jl's features.\label{features}](features.pdf)

# Acknowledgements

F. J. and U. A. are grateful for the support of Eric and Wendy Schmidt through the Schmidt Sciences VESRI "DataWave" project.

# References
